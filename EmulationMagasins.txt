Attribute VB_Name = "EMULATION_PRE_SALON"



Sub Masquer_Onglets()
    ActiveWindow.DisplayWorkbookTabs = False
End Sub
Sub Afficher_Onglets()
    ActiveWindow.DisplayWorkbookTabs = True
End Sub



Sub Mise_Zero_Ou_C_Vide()

Application.DisplayAlerts = False
Application.ScreenUpdating = False

Dim Nom_Feuille As String

Nom_Feuille = "BASE_RL"

For I = 2 To 62     'A MODIF
    For J = 3 To 21 'A MODIF
        If Sheets(Nom_Feuille).Cells(I, J) = "" Then
            Sheets(Nom_Feuille).Cells(I, J) = 0
        End If
    Next J
Next I

End Sub



Sub Tranche_CA()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim CA As Long
    
For I = 8 To 810
    CA = Sheets("BASE HU SU").Cells(I, 4)

    If CA >= 0 And CA <= 7500000 Then: Sheets("BASE").Cells(I, 17) = "CA < 7,5MÄ"
    If CA > 7500000 And CA <= 10000000 Then: Sheets("BASE").Cells(I, 17) = "7,5MÄ < CA < 10MÄ"
    If CA > 10000000 And CA <= 12500000 Then: Sheets("BASE").Cells(I, 17) = "10MÄ < CA < 12,5MÄ"
    If CA > 12500000 And CA <= 15000000 Then: Sheets("BASE").Cells(I, 17) = "12,5MÄ < CA < 15MÄ"
    If CA > 15000000 And CA <= 17500000 Then: Sheets("BASE").Cells(I, 17) = "15MÄ < CA < 17,5MÄ"
    If CA > 17500000 And CA <= 20000000 Then: Sheets("BASE").Cells(I, 17) = "17,5MÄ < CA < 20MÄ"
    If CA > 20000000 And CA <= 25000000 Then: Sheets("BASE").Cells(I, 17) = "20MÄ < CA < 25MÄ"
    If CA > 25000000 And CA <= 30000000 Then: Sheets("BASE").Cells(I, 17) = "25MÄ < CA < 30MÄ"
    If CA > 30000000 And CA <= 40000000 Then: Sheets("BASE").Cells(I, 17) = "30MÄ < CA < 40MÄ"
    If CA > 40000000 And CA <= 50000000 Then: Sheets("BASE").Cells(I, 17) = "40MÄ < CA < 50MÄ"
    If CA > 50000000 And CA <= 70000000 Then: Sheets("BASE").Cells(I, 17) = "50MÄ < CA < 70MÄ"
    If CA > 70000000 Then: Sheets("BASE").Cells(I, 17) = "70MÄ < CA"
    Next I
End Sub



Sub Tranche_Surface()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Surface As Long
    
For I = 8 To 810
    Surface = Sheets("BASE").Cells(I, 10)

    If Surface >= 700 And Surface <= 1000 Then: Sheets("BASE").Cells(I, 18) = "Surface < 1000m≤"
    If Surface > 1000 And Surface <= 1600 Then: Sheets("BASE").Cells(I, 18) = "1000m≤ < Surface < 1600m≤"
    If Surface > 1600 And Surface <= 2200 Then: Sheets("BASE").Cells(I, 18) = "1600m≤ < Surface < 2200m≤"
    If Surface > 2200 And Surface <= 2800 Then: Sheets("BASE").Cells(I, 18) = "2200m≤ < Surface < 2800m≤"
    If Surface > 2800 And Surface <= 4500 Then: Sheets("BASE").Cells(I, 18) = "2800m≤ < Surface < 4500m≤"
    If Surface > 4500 And Surface <= 5500 Then: Sheets("BASE").Cells(I, 18) = "4500m≤ < Surface < 5500m≤"
    If Surface > 5500 And Surface <= 7500 Then: Sheets("BASE").Cells(I, 18) = "5500m≤ < Surface < 7500m≤"
    If Surface > 7500 Then: Sheets("BASE").Cells(I, 18) = "7500m≤ < Surface"

    Next I
End Sub


Sub Tranche_Quota()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Quota As Double
Dim enseigne As String
Dim Nom_Feuille As String

Nom_Feuille = "BASE 3"
    
For I = 2 To 800

    enseigne = Sheets(Nom_Feuille).Cells(I, 4)
    Quota = Sheets(Nom_Feuille).Cells(I, 7)

    Select Case enseigne
        Case "Super U"
            If Quota <= 0.015 Then: Sheets(Nom_Feuille).Cells(I, 13) = "Quota Textile < 1,5%"
            If Quota > 0.015 And Quota <= 0.025 Then: Sheets(Nom_Feuille).Cells(I, 13) = "1,5% < Quota Textile < 2,5%"
            If Quota > 0.025 And Quota <= 0.035 Then: Sheets(Nom_Feuille).Cells(I, 13) = "2,5% < Quota Textile < 3,5%"
            'If Quota > 0.035 And Quota <= 0.045 Then: Sheets(Nom_Feuille).Cells(i, 13) = "3,5% < Quota Textile < 4,5%"
            If Quota > 0.035 Then: Sheets(Nom_Feuille).Cells(I, 13) = "3,5% < Quota Textile"
        Case "Hyper U"
            If Quota <= 0.035 Then: Sheets(Nom_Feuille).Cells(I, 13) = "Quota Textile < 3,5%"
            If Quota > 0.035 Then: Sheets(Nom_Feuille).Cells(I, 13) = "3,5% < Quota Textile"
        End Select
    Next I
End Sub


Sub Concat_Criteres()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String

Nom_Feuille = "BASE 3"

For I = 2 To 781
    Sheets(Nom_Feuille).Cells(I, 14) = Sheets(Nom_Feuille).Cells(I, 12) & "   " & Chr(151) & "   " & Sheets(Nom_Feuille).Cells(I, 13)
Next I

End Sub


Sub Concat_3_Criteres()

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
For I = 8 To 810
    Sheets("BASE").Cells(I, 20) = Sheets("BASE").Cells(I, 17) & "   " & Chr(151) & "   " & Sheets("BASE").Cells(I, 18) & "   " & Chr(151) & "   " & Sheets("BASE").Cells(I, 19)
Next I

End Sub


Sub Main_Emul_Pre_Salon()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

'On Error Resume Next

Dim Nom_PDV As String
Dim Code_PDV As String
Dim Groupe As String

Application.Calculation = xlCalculationManual  ' ou  xlCalculationAutomatic

Nom_PDV = Sheets("MENU1").Cells(12, 1)
Call Affiche_Caracteristiques_FICHE1(Nom_PDV)
Call Affiche_Caracteristiques_PDV(Nom_PDV, "FICHE2")
Call Affiche_Caracteristiques_PDV(Nom_PDV, "FICHE3")

Groupe = Sheets("FICHE2").Cells(11, 15)

'Fill FICHE 1
Call RAZ_FICHE1
Call Routine_Fiche1(Groupe, Nom_PDV)
Call BOLD_COLOR_PDV
Call Affiche_CA_Rang_FICHE1(Nom_PDV)

'Fill FICHE 2
Call Routine_Fiche2(Groupe, Nom_PDV)
Call Graph_VETDESSUS
Call Graph_VETDESSOUS
Call Graph_EQUIPEMENT
Call Feu_Rouge_Orange_Vert
Sheets("FICHE2").Activate
Application.Goto Range("B1")

'Fill FICHE 3
Call Routine_Fiche3(Groupe, Nom_PDV)

Call GO_MENU2

Application.Calculation = xlCalculationAutomatic

End Sub



Sub GO_MENU1()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Affiche_Onglet ("MENU1")
Sheets("MENU1").Activate
Application.Goto Cells(12, 12)

End Sub



Sub GO_MENU2()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Affiche_Onglet ("MENU2")
Sheets("MENU2").Activate
Application.Goto Cells(15, 12)

End Sub



Sub GO_FICHE1()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Affiche_Onglet ("FICHE1")
Sheets("FICHE1").Activate
Application.Goto Cells(7, 1)

End Sub



Sub GO_FICHE2()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Affiche_Onglet ("FICHE2")
Sheets("FICHE2").Activate
Application.Goto Cells(2, 1)

End Sub



Sub GO_FICHE3()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Affiche_Onglet ("FICHE3")
Sheets("FICHE3").Activate
Application.Goto Cells(2, 1)

End Sub



Sub Affiche_Onglet(ByVal Nom_Fiche As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Select Case Nom_Fiche
    Case "MENU1"
        'SHOW
        If Sheets("MENU1").Visible = False Then: Sheets("MENU1").Visible = True
        'HIDE
        If Sheets("MENU2").Visible = True Then: Sheets("MENU2").Visible = False
        If Sheets("FICHE1").Visible = True Then: Sheets("FICHE1").Visible = False
        If Sheets("FICHE2").Visible = True Then: Sheets("FICHE2").Visible = False
        If Sheets("FICHE3").Visible = True Then: Sheets("FICHE3").Visible = False
        If Sheets("BASE").Visible = True Then: Sheets("BASE").Visible = False
        If Sheets("TEMP_FICHE1").Visible = True Then: Sheets("TEMP_FICHE1").Visible = False
        If Sheets("TEMP_FICHE2").Visible = True Then: Sheets("TEMP_FICHE2").Visible = False
        If Sheets("TEMP_FICHE3").Visible = True Then: Sheets("TEMP_FICHE3").Visible = False
        If Sheets("GRAPH_FICHE2").Visible = True Then: Sheets("GRAPH_FICHE2").Visible = False
        If Sheets("GRAPH_FICHE3").Visible = True Then: Sheets("GRAPH_FICHE3").Visible = False
    Case "MENU2"
        'SHOW
        If Sheets("MENU2").Visible = False Then: Sheets("MENU2").Visible = True
        'HIDE
        If Sheets("MENU1").Visible = True Then: Sheets("MENU1").Visible = False
        If Sheets("FICHE1").Visible = True Then: Sheets("FICHE1").Visible = False
        If Sheets("FICHE2").Visible = True Then: Sheets("FICHE2").Visible = False
        If Sheets("FICHE3").Visible = True Then: Sheets("FICHE3").Visible = False
        If Sheets("BASE").Visible = True Then: Sheets("BASE").Visible = False
        If Sheets("TEMP_FICHE1").Visible = True Then: Sheets("TEMP_FICHE1").Visible = False
        If Sheets("TEMP_FICHE2").Visible = True Then: Sheets("TEMP_FICHE2").Visible = False
        If Sheets("TEMP_FICHE3").Visible = True Then: Sheets("TEMP_FICHE3").Visible = False
        If Sheets("GRAPH_FICHE2").Visible = True Then: Sheets("GRAPH_FICHE2").Visible = False
        If Sheets("GRAPH_FICHE3").Visible = True Then: Sheets("GRAPH_FICHE3").Visible = False
    Case "FICHE1"
        'SHOW
        If Sheets("FICHE1").Visible = False Then: Sheets("FICHE1").Visible = True
        'HIDE
        If Sheets("MENU1").Visible = True Then: Sheets("MENU1").Visible = False
        If Sheets("MENU2").Visible = True Then: Sheets("MENU2").Visible = False
        If Sheets("FICHE2").Visible = True Then: Sheets("FICHE2").Visible = False
        If Sheets("FICHE3").Visible = True Then: Sheets("FICHE3").Visible = False
        If Sheets("BASE").Visible = True Then: Sheets("BASE").Visible = False
        If Sheets("TEMP_FICHE1").Visible = True Then: Sheets("TEMP_FICHE1").Visible = False
        If Sheets("TEMP_FICHE2").Visible = True Then: Sheets("TEMP_FICHE2").Visible = False
        If Sheets("TEMP_FICHE3").Visible = True Then: Sheets("TEMP_FICHE3").Visible = False
        If Sheets("GRAPH_FICHE2").Visible = True Then: Sheets("GRAPH_FICHE2").Visible = False
        If Sheets("GRAPH_FICHE3").Visible = True Then: Sheets("GRAPH_FICHE3").Visible = False
    Case "FICHE2"
        'SHOW
        If Sheets("FICHE2").Visible = False Then: Sheets("FICHE2").Visible = True
        'HIDE
        If Sheets("MENU1").Visible = True Then: Sheets("MENU1").Visible = False
        If Sheets("MENU2").Visible = True Then: Sheets("MENU2").Visible = False
        If Sheets("FICHE1").Visible = True Then: Sheets("FICHE1").Visible = False
        If Sheets("FICHE3").Visible = True Then: Sheets("FICHE3").Visible = False
        If Sheets("BASE").Visible = True Then: Sheets("BASE").Visible = False
        If Sheets("TEMP_FICHE1").Visible = True Then: Sheets("TEMP_FICHE1").Visible = False
        If Sheets("TEMP_FICHE2").Visible = True Then: Sheets("TEMP_FICHE2").Visible = False
        If Sheets("TEMP_FICHE3").Visible = True Then: Sheets("TEMP_FICHE3").Visible = False
        If Sheets("GRAPH_FICHE2").Visible = True Then: Sheets("GRAPH_FICHE2").Visible = False
        If Sheets("GRAPH_FICHE3").Visible = True Then: Sheets("GRAPH_FICHE3").Visible = False
    Case "FICHE3"
        'SHOW
        If Sheets("FICHE3").Visible = False Then: Sheets("FICHE3").Visible = True
        'HIDE
        If Sheets("FICHE1").Visible = True Then: Sheets("FICHE1").Visible = False
        If Sheets("MENU1").Visible = True Then: Sheets("MENU1").Visible = False
        If Sheets("MENU2").Visible = True Then: Sheets("MENU2").Visible = False
        If Sheets("FICHE2").Visible = True Then: Sheets("FICHE2").Visible = False
        If Sheets("BASE").Visible = True Then: Sheets("BASE").Visible = False
        If Sheets("TEMP_FICHE1").Visible = True Then: Sheets("TEMP_FICHE1").Visible = False
        If Sheets("TEMP_FICHE2").Visible = True Then: Sheets("TEMP_FICHE2").Visible = False
        If Sheets("TEMP_FICHE3").Visible = True Then: Sheets("TEMP_FICHE3").Visible = False
        If Sheets("GRAPH_FICHE2").Visible = True Then: Sheets("GRAPH_FICHE2").Visible = False
        If Sheets("GRAPH_FICHE3").Visible = True Then: Sheets("GRAPH_FICHE3").Visible = False
    Case Else
End Select
End Sub



Sub Univers_Comparaison()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("UNIVERS").Range("B3:B150").ClearContents

For I = 2 To Sheets("TEMP_FICHE2").Range("A1000000").End(xlUp).Row
        Sheets("UNIVERS").Cells(I + 1, 2) = Sheets("TEMP_FICHE2").Cells(I, 3)
Next I
        
End Sub
Sub Affiche_Univers_Comparaison()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

If Sheets("UNIVERS").Visible = False Then: Sheets("UNIVERS").Visible = True

Sheets("UNIVERS").Activate
Application.Goto Range("A1")
        
End Sub

Sub Affiche_Caracteristiques_FICHE1(ByVal Nom_PDV As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_PDV As String
Dim enseigne As String
Dim Gep As String
Dim Typologie As String
Dim Surface As String
Dim CA_Mag As Long
Dim CA_Txt As Long
Dim Quota As Double
Dim Code_Dpt As String
Dim Groupe As String
Dim GoogleMap As String
Dim Nbre_PDV As Long
Dim Etablissement As String
Dim Tranche_CA As String
Dim Tranche_Surface As String
Dim Tranche_Quota As String
Dim Nom_Feuille As String

Nom_Feuille = "FICHE1"

For I = 8 To Sheets("BASE").Range("A1000000").End(xlUp).Row
    If Sheets("BASE").Cells(I, 3) Like Nom_PDV Then
        enseigne = Sheets("BASE").Cells(I, 4)
        Code_PDV = Sheets("BASE").Cells(I, 1)
        Code_Dpt = Sheets("BASE").Cells(I, 5)
        GoogleMap = Sheets("BASE").Cells(I, 9)
        Surface = Sheets("BASE").Cells(I, 10)
        Etablissement = Sheets("BASE").Cells(I, 13)
        Typologie = Sheets("BASE").Cells(I, 14)
        Gep = Sheets("BASE").Cells(I, 12)
        Groupe = Sheets("BASE").Cells(I, 20)

        CA_Mag = Sheets("BASE").Cells(I, 22)
        CA_Txt = Sheets("BASE").Cells(I, 24)
        Quota = Sheets("BASE").Cells(I, 25)
        Tranche_CA = Sheets("BASE").Cells(I, 17)
        Tranche_Surface = Sheets("BASE").Cells(I, 18)
        Tranche_Quota = Sheets("BASE").Cells(I, 19)
    End If
Next I

'PremiËre Partie
Sheets(Nom_Feuille).Cells(13, 13) = Code_PDV
Sheets(Nom_Feuille).Cells(13, 36) = Nom_PDV
Sheets(Nom_Feuille).Cells(14, 36) = Gep
Sheets(Nom_Feuille).Cells(15, 36) = Tranche_Surface
Sheets(Nom_Feuille).Cells(16, 36) = Typologie
Sheets(Nom_Feuille).Cells(17, 36) = Etablissement
Sheets(Nom_Feuille).Cells(18, 36) = Tranche_CA
Sheets(Nom_Feuille).Cells(19, 36) = Tranche_Quota

'DeuxiËme Partie
'Sheets(Nom_Feuille).Cells(14, 72) = Groupe

'Seek pour le Nb de PDV de l'Univers
Sheets("BASE").Activate
Sheets("BASE").[A7].AutoFilter Field:=20, Criteria1:=Groupe
Nbre_PDV = Application.WorksheetFunction.Subtotal(103, Range(Cells(8, 1), Cells(2000, 1)))
Sheets("BASE").ShowAllData

Sheets(Nom_Feuille).Cells(13, 80) = Nbre_PDV

End Sub

Sub Affiche_Caracteristiques_PDV(ByVal Nom_PDV As String, ByVal Nom_Feuille As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_PDV As String
Dim enseigne As String
Dim Gep As String
Dim Typologie As String
Dim Surface As String
Dim CA_Mag As Long
Dim CA_Txt As Long
Dim Quota As Double
Dim Code_Dpt As String
Dim Groupe As String
Dim GoogleMap As String
Dim Nbre_PDV As Long

For I = 8 To Sheets("BASE").Range("A1000000").End(xlUp).Row
    If Sheets("BASE").Cells(I, 3) Like Nom_PDV Then
            
        enseigne = Sheets("BASE").Cells(I, 4)
        Code_PDV = Sheets("BASE").Cells(I, 1)
        Code_Dpt = Sheets("BASE").Cells(I, 5)
        GoogleMap = Sheets("BASE").Cells(I, 9)
        Surface = Sheets("BASE").Cells(I, 10)
        Typologie = Sheets("BASE").Cells(I, 14)
        Gep = Sheets("BASE").Cells(I, 12)
        Groupe = Sheets("BASE").Cells(I, 20)

        CA_Mag = Sheets("BASE").Cells(I, 22)
        CA_Txt = Sheets("BASE").Cells(I, 24)
        Quota = Sheets("BASE").Cells(I, 25)
        
    End If
Next I

'PremiËre Partie
Sheets(Nom_Feuille).Cells(4, 16) = Code_PDV
Sheets(Nom_Feuille).Cells(4, 20) = Nom_PDV
Sheets(Nom_Feuille).Cells(4, 40) = "DÈpt. " & Code_Dpt
Sheets(Nom_Feuille).Cells(4, 40).Hyperlinks.Delete
Sheets(Nom_Feuille).Hyperlinks.Add Anchor:=Sheets(Nom_Feuille).Cells(4, 40), Address:= _
        "https://www.google.fr/maps?q=" & GoogleMap, TextToDisplay:="DÈpt. " & Code_Dpt
Sheets(Nom_Feuille).Cells(4, 40).Font.Size = 16
Sheets(Nom_Feuille).Cells(5, 20) = "Surface " & Surface & " m≤"
Sheets(Nom_Feuille).Cells(5, 24) = Typologie
Sheets(Nom_Feuille).Cells(6, 21) = CA_Mag
Sheets(Nom_Feuille).Cells(7, 21) = CA_Txt
Sheets(Nom_Feuille).Cells(7, 27) = Quota

'DeuxiËme Partie
Sheets(Nom_Feuille).Cells(11, 15) = Groupe

'Seek pour le Nb de PDV de l'Univers
Sheets("BASE").Activate
Sheets("BASE").[A7].AutoFilter Field:=20, Criteria1:=Groupe
Nbre_PDV = Application.WorksheetFunction.Subtotal(103, Range(Cells(8, 1), Cells(2000, 1)))
Sheets("BASE").ShowAllData

Sheets(Nom_Feuille).Cells(12, 21) = Nbre_PDV

End Sub



Sub test()
Call TRI_TEST("TEMP_FICHE1", 24)
End Sub
Sub TRI_TEST(Nom_Feuille As String, ByVal Col_Tri As Integer)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets(Nom_Feuille).Activate

Columns("A:ZZ").Select
Selection.Sort Key1:=Cells(1, Col_Tri), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

Application.Goto Range("A108")
End Sub



Sub Tri_Rank(ByVal LBL_Rank As String, Nom_Feuille As String, ByVal Col_Tri As Integer, ByVal Col_Rank As Integer)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim compteur As Integer

Sheets(Nom_Feuille).Activate

Columns(Col_Rank).ClearContents
Columns("A:ZZ").Select
Selection.Sort Key1:=Cells(1, Col_Tri), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

Cells(1, Col_Rank) = LBL_Rank
For I = 2 To Sheets(Nom_Feuille).Range("A1000000").End(xlUp).Row
    Cells(I, Col_Rank) = I - 1
Next I

End Sub



Sub Show_Rank(ByVal Col_Tri As Integer, ByVal Ligne_Write As Integer, ByVal Col_Read As Integer, ByVal Col_Write As Integer)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim ligne As Integer
Dim Nb_PDV As Integer
Dim Nom_PDV As String
Dim Position_PDV As Integer
Dim Nom_Temp As String
Dim Deb As Integer

Sheets("TEMP_FICHE1").Activate
ligne = Sheets("TEMP_FICHE1").Range("A1000000").End(xlUp).Row
Nom_PDV = Sheets("FICHE1").Cells(13, 36)

Nb_PDV = ligne - 1
Nom_Temp = "TEMP_FICHE1"

'TRI et AFFICHE PREMIERES COLONNES
Select Case Col_Tri
    Case Is > 0
        Columns("A:ZZ").Select
        Selection.Sort Key1:=Cells(1, Col_Tri), Order1:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers
    
        For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
            If Sheets(Nom_Temp).Cells(I, 3) Like Nom_PDV Then
                Position_PDV = I
            End If
        Next I

        'CALIBRAGE ZONE AFFICHAGE
        Select Case Nb_PDV
            Case Is > 30
                If Position_PDV > 30 Then
                    Deb = Position_PDV - 29
                Else
                    Deb = 2
                End If
            Case Is <= 30
                Deb = 2
        End Select
    
        'SHOW 3 OU 4 PREMIERES COLONNES
        Select Case Ligne_Write
            Case 30
                For I = 1 To 30
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 1) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 1)
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 8) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 3)
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 20) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 10)
                Next I
            Case 64, 98, 132
                For I = 1 To 30
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 1) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 1)
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 8) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 3)
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 20) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 10)
                    Sheets("FICHE1").Cells(Ligne_Write + I - 1, 25) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, 107)
                Next I
        End Select
        
        'SHOW LA COLONNE RANK DU RAYON
        For I = 1 To 30
            Sheets("FICHE1").Cells(Ligne_Write + I - 1, Col_Write) = Sheets("TEMP_FICHE1").Cells(Deb + I - 1, Col_Read)
        Next I
End Select
    


End Sub

Sub BOLD_COLOR_PDV()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_PDV As String

Nom_PDV = Sheets("FICHE1").Cells(13, 36)
Sheets("FICHE1").Activate

'BOLD_GENERAL

For I = 30 To 59
    If Sheets("FICHE1").Cells(I, 8) Like Nom_PDV Then
        Range(Cells(I, 1), Cells(I, 66)).Font.Bold = True
        Cells(I, 8).Interior.Color = RGB(255, 217, 102)
    Else
        Range(Cells(I, 1), Cells(I, 66)).Font.Bold = False
        Cells(I, 8).Interior.Color = RGB(255, 255, 255)
    End If
Next I

'BOLD_VDESSUS

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 8) Like Nom_PDV Then
        Range(Cells(I, 1), Cells(I, 72)).Font.Bold = True
        Cells(I, 8).Interior.Color = RGB(255, 217, 102)
    Else
        Range(Cells(I, 1), Cells(I, 72)).Font.Bold = False
        Cells(I, 8).Interior.Color = RGB(255, 255, 255)
    End If
Next I

'BOLD_VDESSOUS

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 8) Like Nom_PDV Then
        Range(Cells(I, 1), Cells(I, 73)).Font.Bold = True
        Cells(I, 8).Interior.Color = RGB(255, 217, 102)
    Else
        Range(Cells(I, 1), Cells(I, 73)).Font.Bold = False
        Cells(I, 8).Interior.Color = RGB(255, 255, 255)
    End If
Next I

'BOLD_EQUIPEMENT
For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 8) Like Nom_PDV Then
        Range(Cells(I, 1), Cells(I, 73)).Font.Bold = True
        Cells(I, 8).Interior.Color = RGB(255, 217, 102)
    Else
        Range(Cells(I, 1), Cells(I, 73)).Font.Bold = False
        Cells(I, 8).Interior.Color = RGB(255, 255, 255)
    End If
Next I

End Sub




Sub Affiche_CA_Rang_FICHE1(ByVal Nom_PDV As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String

Nom_Feuille = "FICHE1"

'Ecriture dans les variables
For I = 2 To Sheets("TEMP_FICHE1").Range("A1000000").End(xlUp).Row
    If Sheets("TEMP_FICHE1").Cells(I, 3) Like Nom_PDV Then
        'Variables CA
        CA_V_Dessus = Sheets("TEMP_FICHE1").Cells(I, 64)
        CA_V_Dessous = Sheets("TEMP_FICHE1").Cells(I, 65)
        CA_Equipement = Sheets("TEMP_FICHE1").Cells(I, 66)
        
        CA_V_BB = Sheets("TEMP_FICHE1").Cells(I, 67)
        CA_V_Enf = Sheets("TEMP_FICHE1").Cells(I, 68)
        CA_V_Fem = Sheets("TEMP_FICHE1").Cells(I, 69)
        CA_V_Hom = Sheets("TEMP_FICHE1").Cells(I, 70)
        CA_Nuit = Sheets("TEMP_FICHE1").Cells(I, 71)
        CA_Bain = Sheets("TEMP_FICHE1").Cells(I, 75)
        
        CA_SV_BB = Sheets("TEMP_FICHE1").Cells(I, 80)
        CA_SV_Enf = Sheets("TEMP_FICHE1").Cells(I, 81)
        CA_SV_Fem = Sheets("TEMP_FICHE1").Cells(I, 82)
        CA_SV_Hom = Sheets("TEMP_FICHE1").Cells(I, 83)
        CA_Chaussettes = Sheets("TEMP_FICHE1").Cells(I, 84)
        CA_Collants = Sheets("TEMP_FICHE1").Cells(I, 89)
        CA_Mercerie = Sheets("TEMP_FICHE1").Cells(I, 90)
        CA_Sem_lac = Sheets("TEMP_FICHE1").Cells(I, 91)

        CA_LDM = Sheets("TEMP_FICHE1").Cells(I, 92)
        CA_Pueri = Sheets("TEMP_FICHE1").Cells(I, 95)
        CA_Acc = Sheets("TEMP_FICHE1").Cells(I, 98)
        CA_Chauss_ext = Sheets("TEMP_FICHE1").Cells(I, 99)
        CA_Chauss_int = Sheets("TEMP_FICHE1").Cells(I, 100)
        
        'Variables Rang
        Rang_textile = Sheets("TEMP_FICHE1").Cells(I, 107)
        
        Rang_V_Dessus = Sheets("TEMP_FICHE1").Cells(I, 108)
        Rang_V_Dessous = Sheets("TEMP_FICHE1").Cells(I, 109)
        Rang_Equipement = Sheets("TEMP_FICHE1").Cells(I, 110)
        
        Rang_V_BB = Sheets("TEMP_FICHE1").Cells(I, 111)
        Rang_V_Enf = Sheets("TEMP_FICHE1").Cells(I, 112)
        Rang_V_Fem = Sheets("TEMP_FICHE1").Cells(I, 113)
        Rang_V_Hom = Sheets("TEMP_FICHE1").Cells(I, 114)
        Rang_Nuit = Sheets("TEMP_FICHE1").Cells(I, 115)
        Rang_Bain = Sheets("TEMP_FICHE1").Cells(I, 116)
        
        Rang_SV_BB = Sheets("TEMP_FICHE1").Cells(I, 117)
        Rang_SV_Enf = Sheets("TEMP_FICHE1").Cells(I, 118)
        Rang_SV_Fem = Sheets("TEMP_FICHE1").Cells(I, 119)
        Rang_SV_Hom = Sheets("TEMP_FICHE1").Cells(I, 120)
        Rang_Chaussettes = Sheets("TEMP_FICHE1").Cells(I, 121)
        Rang_Collants = Sheets("TEMP_FICHE1").Cells(I, 122)
        Rang_Mercerie = Sheets("TEMP_FICHE1").Cells(I, 123)
        Rang_Sem_lac = Sheets("TEMP_FICHE1").Cells(I, 124)

        Rang_LDM = Sheets("TEMP_FICHE1").Cells(I, 125)
        Rang_Pueri = Sheets("TEMP_FICHE1").Cells(I, 126)
        Rang_Acc = Sheets("TEMP_FICHE1").Cells(I, 127)
        Rang_Chauss_ext = Sheets("TEMP_FICHE1").Cells(I, 128)
        Rang_Chauss_int = Sheets("TEMP_FICHE1").Cells(I, 129)
    End If

'Ecriture dans la fiche

        'Variables CA
        Sheets("FICHE1").Cells(50, 85) = CA_V_Dessus
        Sheets("FICHE1").Cells(53, 85) = CA_V_Dessous
        Sheets("FICHE1").Cells(56, 85) = CA_Equipement
        
        Sheets("FICHE1").Cells(69, 85) = CA_V_Dessus
        Sheets("FICHE1").Cells(72, 85) = CA_V_BB
        Sheets("FICHE1").Cells(75, 85) = CA_V_Enf
        Sheets("FICHE1").Cells(78, 85) = CA_V_Fem
        Sheets("FICHE1").Cells(81, 85) = CA_V_Hom
        Sheets("FICHE1").Cells(84, 85) = CA_Nuit
        Sheets("FICHE1").Cells(87, 85) = CA_Bain
        
        Sheets("FICHE1").Cells(103, 85) = CA_V_Dessous
        Sheets("FICHE1").Cells(106, 85) = CA_SV_BB
        Sheets("FICHE1").Cells(109, 85) = CA_SV_Enf
        Sheets("FICHE1").Cells(112, 85) = CA_SV_Fem
        Sheets("FICHE1").Cells(115, 85) = CA_SV_Hom
        Sheets("FICHE1").Cells(118, 85) = CA_Chaussettes
        Sheets("FICHE1").Cells(121, 85) = CA_Collants
        Sheets("FICHE1").Cells(124, 85) = CA_Mercerie
        Sheets("FICHE1").Cells(127, 85) = CA_Sem_lac

        Sheets("FICHE1").Cells(139, 85) = CA_Equipement
        Sheets("FICHE1").Cells(142, 85) = CA_LDM
        Sheets("FICHE1").Cells(145, 85) = CA_Pueri
        Sheets("FICHE1").Cells(148, 85) = CA_Acc
        Sheets("FICHE1").Cells(151, 85) = CA_Chauss_ext
        Sheets("FICHE1").Cells(154, 85) = CA_Chauss_int
        
        'Variables Rang
        If Rang_textile = 1 Then: Sheets("FICHE1").Cells(47, 91) = 1: Else: Sheets("FICHE1").Cells(47, 91) = Rang_textile - 1
        
        If Rang_V_Dessus = 1 Then: Sheets("FICHE1").Cells(50, 91) = 1: Else: Sheets("FICHE1").Cells(50, 91) = Rang_V_Dessus - 1
        If Rang_V_Dessous = 1 Then: Sheets("FICHE1").Cells(53, 91) = 1: Else: Sheets("FICHE1").Cells(53, 91) = Rang_V_Dessous - 1
        If Rang_Equipement = 1 Then: Sheets("FICHE1").Cells(56, 91) = 1: Else: Sheets("FICHE1").Cells(56, 91) = Rang_Equipement - 1
        
        If Rang_V_Dessus = 1 Then: Sheets("FICHE1").Cells(69, 91) = 1: Else: Sheets("FICHE1").Cells(69, 91) = Rang_V_Dessus - 1
        If Rang_V_BB = 1 Then: Sheets("FICHE1").Cells(72, 91) = 1: Else: Sheets("FICHE1").Cells(72, 91) = Rang_V_BB - 1
        If Rang_V_Enf = 1 Then: Sheets("FICHE1").Cells(75, 91) = Rang_V_Enf: Else: Sheets("FICHE1").Cells(75, 91) = Rang_V_Enf - 1
        If Rang_V_Fem = 1 Then: Sheets("FICHE1").Cells(78, 91) = Rang_V_Fem: Else: Sheets("FICHE1").Cells(78, 91) = Rang_V_Fem - 1
        If Rang_V_Hom = 1 Then: Sheets("FICHE1").Cells(81, 91) = Rang_V_Hom: Else: Sheets("FICHE1").Cells(81, 91) = Rang_V_Hom - 1
        If Rang_Nuit = 1 Then: Sheets("FICHE1").Cells(84, 91) = Rang_Nuit: Else: Sheets("FICHE1").Cells(84, 91) = Rang_Nuit - 1
        If Rang_Bain = 1 Then: Sheets("FICHE1").Cells(87, 91) = Rang_Bain: Else: Sheets("FICHE1").Cells(87, 91) = Rang_Bain - 1
        
        If Rang_V_Dessous = 1 Then: Sheets("FICHE1").Cells(103, 91) = Rang_V_Dessous: Else: Sheets("FICHE1").Cells(103, 91) = Rang_V_Dessous - 1
        If Rang_SV_BB = 1 Then: Sheets("FICHE1").Cells(106, 91) = Rang_SV_BB: Else: Sheets("FICHE1").Cells(106, 91) = Rang_SV_BB - 1
        If Rang_SV_Enf = 1 Then: Sheets("FICHE1").Cells(109, 91) = Rang_SV_Enf: Else: Sheets("FICHE1").Cells(109, 91) = Rang_SV_Enf - 1
        If Rang_SV_Fem = 1 Then: Sheets("FICHE1").Cells(112, 91) = Rang_SV_Fem: Else: Sheets("FICHE1").Cells(112, 91) = Rang_SV_Fem - 1
        If Rang_SV_Hom = 1 Then: Sheets("FICHE1").Cells(115, 91) = Rang_SV_Hom: Else: Sheets("FICHE1").Cells(115, 91) = Rang_SV_Hom - 1
        If Rang_Chaussettes = 1 Then: Sheets("FICHE1").Cells(118, 91) = Rang_Chaussettes: Else: Sheets("FICHE1").Cells(118, 91) = Rang_Chaussettes - 1
        If Rang_Collants = 1 Then: Sheets("FICHE1").Cells(121, 91) = Rang_Collants: Else: Sheets("FICHE1").Cells(121, 91) = Rang_Collants - 1
        If Rang_Mercerie = 1 Then: Sheets("FICHE1").Cells(124, 91) = Rang_Mercerie: Else: Sheets("FICHE1").Cells(124, 91) = Rang_Mercerie - 1
        If Rang_Sem_lac = 1 Then: Sheets("FICHE1").Cells(127, 91) = Rang_Sem_lac: Else: Sheets("FICHE1").Cells(127, 91) = Rang_Sem_lac - 1

        If Rang_Equipement = 1 Then: Sheets("FICHE1").Cells(139, 91) = Rang_Equipement: Else: Sheets("FICHE1").Cells(139, 91) = Rang_Equipement - 1
        If Rang_LDM = 1 Then: Sheets("FICHE1").Cells(142, 91) = Rang_LDM: Else: Sheets("FICHE1").Cells(142, 91) = Rang_LDM - 1
        If Rang_Pueri = 1 Then: Sheets("FICHE1").Cells(145, 91) = Rang_Pueri: Else: Sheets("FICHE1").Cells(145, 91) = Rang_Pueri - 1
        If Rang_Acc = 1 Then: Sheets("FICHE1").Cells(148, 91) = Rang_Acc: Else: Sheets("FICHE1").Cells(148, 91) = Rang_Acc - 1
        If Rang_Chauss_ext = 1 Then: Sheets("FICHE1").Cells(151, 91) = Rang_Chauss_ext: Else: Sheets("FICHE1").Cells(151, 91) = Rang_Chauss_ext - 1
        If Rang_Chauss_int = 1 Then: Sheets("FICHE1").Cells(154, 91) = Rang_Chauss_int: Else: Sheets("FICHE1").Cells(154, 91) = Rang_Chauss_int - 1

    
Next I

End Sub



Sub Valide_Objectifs()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String
Nom_Feuille = "FICHE1"

'V. Dessus
Sheets(Nom_Feuille).Cells(50, 106) = Sheets(Nom_Feuille).Cells(69, 106)
Sheets(Nom_Feuille).Cells(50, 111) = Sheets(Nom_Feuille).Cells(69, 111)
Sheets(Nom_Feuille).Cells(50, 116) = Sheets(Nom_Feuille).Cells(69, 116)

'V.Dessous
Sheets(Nom_Feuille).Cells(53, 106) = Sheets(Nom_Feuille).Cells(103, 106)
Sheets(Nom_Feuille).Cells(53, 111) = Sheets(Nom_Feuille).Cells(103, 111)
Sheets(Nom_Feuille).Cells(53, 116) = Sheets(Nom_Feuille).Cells(103, 116)

'Equipement
Sheets(Nom_Feuille).Cells(56, 106) = Sheets(Nom_Feuille).Cells(139, 106)
Sheets(Nom_Feuille).Cells(56, 111) = Sheets(Nom_Feuille).Cells(139, 111)
Sheets(Nom_Feuille).Cells(56, 116) = Sheets(Nom_Feuille).Cells(139, 116)


End Sub

Sub RAZ_FICHE1()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

'RAZ Obj gÈnÈral
    Cells(50, 106) = ""
    Cells(50, 111) = ""
    Cells(50, 116) = ""

    Cells(53, 106) = ""
    Cells(53, 111) = ""
    Cells(53, 116) = ""

    Cells(56, 106) = ""
    Cells(56, 111) = ""
    Cells(56, 116) = ""

'RAZ Obj Dessus
    Cells(71, 106) = 0
    Cells(74, 106) = 0
    Cells(77, 106) = 0
    Cells(80, 106) = 0
    Cells(83, 106) = 0
    Cells(86, 106) = 0

'RAZ Obj Dessous
    Cells(105, 106) = 0
    Cells(108, 106) = 0
    Cells(111, 106) = 0
    Cells(114, 106) = 0
    Cells(117, 106) = 0
    Cells(120, 106) = 0
    Cells(123, 106) = 0
    Cells(126, 106) = 0

'RAZ Obj Dessous
    Cells(141, 106) = 0
    Cells(144, 106) = 0
    Cells(147, 106) = 0
    Cells(150, 106) = 0
    Cells(153, 106) = 0
    
Application.Goto Range("A1"), True

End Sub
Sub Routine_Fiche1(ByVal Groupe As String, ByVal Nom_PDV As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String, Nom_Temp As String, Nom_Fiche As String
Dim ligne As Long, Nb_PDV_Tiers As Long, Nb_PDV_Univ As Long
Dim Quota_Mag As Double, Quota_Moy_Univ As Double, Quota_Tiers_Univ As Double, Quota_Max_Univ As Double
Dim CA_Moy_Univ As Double, CA_Tiers_Univ As Double, CA_Max_Univ As Double
Dim CA_Rayon As Double
Dim Evol_CA_Moyen_Univ As Double, Evol_CA_Tiers_Univ As Double

Nom_Feuille = "BASE"
Nom_Temp = "TEMP_FICHE1"
Nom_Fiche = "FICHE1"

Mag_tiers = 0

Sheets(Nom_Feuille).Activate
ligne = Sheets(Nom_Feuille).Range("A200000").End(xlUp).Row

'Effacement de l'onglet TEMP
    Sheets(Nom_Temp).Range("A1:ZZ20000").ClearContents

'Filtre dans BASE sur "Groupe" et copie dans l'onglet TEMP
    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).[A7].AutoFilter Field:=20, Criteria1:=Groupe
    
    Set LF = Sheets(Nom_Feuille).Range(Cells(7, 1), Cells(ligne, 200)).SpecialCells(xlCellTypeVisible)
    LF.Copy
    Sheets(Nom_Temp).Activate
    Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Goto Range("A1")

    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).ShowAllData

'TRI + RANK
'GENERAL
Call Tri_Rank("RK TEXTILE", "TEMP_FICHE1", 24, 107)
Call Tri_Rank("RK VET DESSUS", "TEMP_FICHE1", 64, 108)
Call Tri_Rank("RK VET DESSOUS", "TEMP_FICHE1", 65, 109)
Call Tri_Rank("RK EQUIPEMENT", "TEMP_FICHE1", 66, 110)

'VET DESSUS
Call Tri_Rank("RK VET LAYETTE", "TEMP_FICHE1", 67, 111)
Call Tri_Rank("RK VET ENF", "TEMP_FICHE1", 68, 112)
Call Tri_Rank("RK VET FEM", "TEMP_FICHE1", 69, 113)
Call Tri_Rank("RK VET HOM", "TEMP_FICHE1", 70, 114)
Call Tri_Rank("RK NUIT", "TEMP_FICHE1", 71, 115)
Call Tri_Rank("RK BAIN", "TEMP_FICHE1", 75, 116)

'VET DESSOUS
Call Tri_Rank("RK S.VET LAYETTE", "TEMP_FICHE1", 80, 117)
Call Tri_Rank("RK S.VET ENF", "TEMP_FICHE1", 81, 118)
Call Tri_Rank("RK S.VET FEM", "TEMP_FICHE1", 82, 119)
Call Tri_Rank("RK S.VET HOM", "TEMP_FICHE1", 83, 120)
Call Tri_Rank("RK CHAUSSETTES", "TEMP_FICHE1", 84, 121)
Call Tri_Rank("RK COLLANTS", "TEMP_FICHE1", 89, 122)
Call Tri_Rank("RK MERCERIE", "TEMP_FICHE1", 90, 123)
Call Tri_Rank("RK SEM_LAC", "TEMP_FICHE1", 91, 124)

'EQUIPEMENT
Call Tri_Rank("RK LDM", "TEMP_FICHE1", 92, 125)
Call Tri_Rank("RK PUERI", "TEMP_FICHE1", 95, 126)
Call Tri_Rank("RK ACCESS", "TEMP_FICHE1", 98, 127)
Call Tri_Rank("RK CHAUSS EXT", "TEMP_FICHE1", 99, 128)
Call Tri_Rank("RK CHAUSS INT", "TEMP_FICHE1", 100, 129)



'SHOW RANK
'GENERAL
Sheets("FICHE1").Range("A30:BZ59").ClearContents
Call Show_Rank(107, 30, 107, 25)
Call Show_Rank(107, 30, 108, 38)
Call Show_Rank(107, 30, 109, 52)
Call Show_Rank(107, 30, 110, 66)

'VET DU DESSUS
Sheets("FICHE1").Range("A64:BZ93").ClearContents
Call Show_Rank(108, 64, 108, 32)
Call Show_Rank(108, 64, 111, 39)
Call Show_Rank(108, 64, 112, 46)
Call Show_Rank(108, 64, 113, 53)
Call Show_Rank(108, 64, 114, 60)
Call Show_Rank(108, 64, 115, 66)
Call Show_Rank(108, 64, 116, 72)

'VET DU DESSOUS
Sheets("FICHE1").Range("A98:BZ127").ClearContents
Call Show_Rank(109, 98, 109, 31)
Call Show_Rank(109, 98, 117, 37)
Call Show_Rank(109, 98, 118, 42)
Call Show_Rank(109, 98, 119, 47)
Call Show_Rank(109, 98, 120, 52)
Call Show_Rank(109, 98, 121, 57)
Call Show_Rank(109, 98, 122, 62)
Call Show_Rank(109, 98, 123, 67)
Call Show_Rank(109, 98, 124, 73)

'EQUIPEMENT
Sheets("FICHE1").Range("A132:BZ161").ClearContents
Call Show_Rank(110, 132, 110, 33)
Call Show_Rank(110, 132, 125, 41)
Call Show_Rank(110, 132, 126, 49)
Call Show_Rank(110, 132, 127, 57)
Call Show_Rank(110, 132, 128, 65)
Call Show_Rank(110, 132, 129, 72)

Application.Goto Range("A7")

End Sub


Sub Routine_Fiche2(ByVal Groupe As String, ByVal Nom_PDV As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String, Nom_Temp As String, Nom_Fiche As String
Dim ligne As Long, Nb_PDV_Tiers As Long, Nb_PDV_Univ As Long
Dim Quota_Mag As Double, Quota_Moy_Univ As Double, Quota_Tiers_Univ As Double, Quota_Max_Univ As Double
Dim CA_Moy_Univ As Double, CA_Tiers_Univ As Double, CA_Max_Univ As Double
Dim CA_Rayon As Double
Dim Evol_CA_Moyen_Univ As Double, Evol_CA_Tiers_Univ As Double

Nom_Feuille = "BASE"
Nom_Temp = "TEMP_FICHE2"
Nom_Fiche = "FICHE2"

ligne = 0: Mag_tiers = 0
Quota_Moy_Univ = 0: Quota_Tiers_Univ = 0: Quota_Max_Univ = 0: Nb_PDV_Univ = 0: Nb_PDV_Tiers = 0: Quota_Mag = 0
CA_Moy_Univ = 0: CA_Tiers_Univ = 0: CA_Max_Univ = 0
Evol_CA_Moyen_Univ = 0: Evol_CA_Tiers_Univ = 0


Sheets(Nom_Feuille).Activate
ligne = Sheets(Nom_Feuille).Range("A200000").End(xlUp).Row


'Effacement de l'onglet TEMP
    Sheets(Nom_Temp).Range("A1:ZZ20000").ClearContents

'Filtre dans BASE sur "Groupe" et copie dans l'onglet TEMP
    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).[A7].AutoFilter Field:=20, Criteria1:=Groupe
    
    Set LF = Sheets(Nom_Feuille).Range(Cells(7, 1), Cells(ligne, 200)).SpecialCells(xlCellTypeVisible)
    LF.Copy
    Sheets(Nom_Temp).Activate
    Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Goto Range("A1")

    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).ShowAllData

'Remplissage partie Performances Rayons Permanents
For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
  If Sheets(Nom_Temp).Cells(I, 3) Like Nom_PDV Then
        
        '-----------------------------------------
        'GROUPE VET DU DESSUS
        '-----------------------------------------
        'CA
        Sheets(Nom_Fiche).Cells(20, 6) = Sheets(Nom_Temp).Cells(I, 64)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 6) = (Sheets(Nom_Temp).Cells(I, 64) / Sheets(Nom_Temp).Cells(I, 26)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 6) = Sheets(Nom_Temp).Cells(I, 64) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET HOMME
        'CA
        Sheets(Nom_Fiche).Cells(20, 11) = Sheets(Nom_Temp).Cells(I, 70)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 11) = (Sheets(Nom_Temp).Cells(I, 70) / Sheets(Nom_Temp).Cells(I, 32)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 11) = Sheets(Nom_Temp).Cells(I, 70) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET FEMME
        'CA
        Sheets(Nom_Fiche).Cells(20, 16) = Sheets(Nom_Temp).Cells(I, 69)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 16) = (Sheets(Nom_Temp).Cells(I, 69) / Sheets(Nom_Temp).Cells(I, 31)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 16) = Sheets(Nom_Temp).Cells(I, 69) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET ENFANT
        'CA
        Sheets(Nom_Fiche).Cells(20, 21) = Sheets(Nom_Temp).Cells(I, 68)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 21) = (Sheets(Nom_Temp).Cells(I, 68) / Sheets(Nom_Temp).Cells(I, 30)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 21) = Sheets(Nom_Temp).Cells(I, 68) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET LAYETTE
        'CA
        Sheets(Nom_Fiche).Cells(20, 26) = Sheets(Nom_Temp).Cells(I, 67)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 26) = (Sheets(Nom_Temp).Cells(I, 67) / Sheets(Nom_Temp).Cells(I, 29)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 26) = Sheets(Nom_Temp).Cells(I, 67) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET NUIT
        'CA
        Sheets(Nom_Fiche).Cells(20, 31) = Sheets(Nom_Temp).Cells(I, 71)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 31) = (Sheets(Nom_Temp).Cells(I, 71) / Sheets(Nom_Temp).Cells(I, 33)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 31) = Sheets(Nom_Temp).Cells(I, 71) / Sheets(Nom_Temp).Cells(I, 24)
        
        'VET BAIN
        'CA
        Sheets(Nom_Fiche).Cells(20, 36) = Sheets(Nom_Temp).Cells(I, 75)
        'Evol CA
        Sheets(Nom_Fiche).Cells(21, 36) = (Sheets(Nom_Temp).Cells(I, 75) / Sheets(Nom_Temp).Cells(I, 37)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(22, 36) = Sheets(Nom_Temp).Cells(I, 75) / Sheets(Nom_Temp).Cells(I, 24)
        
        
        
        '-----------------------------------------
        'GROUPE VET DU DESSOUS
        '-----------------------------------------
        'GROUPE VET DU DESSOUS
        'CA
        Sheets(Nom_Fiche).Cells(45, 6) = Sheets(Nom_Temp).Cells(I, 65)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 6) = (Sheets(Nom_Temp).Cells(I, 65) / Sheets(Nom_Temp).Cells(I, 27)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 6) = Sheets(Nom_Temp).Cells(I, 65) / Sheets(Nom_Temp).Cells(I, 24)
        
        'S.VET HOMME
        'CA
        Sheets(Nom_Fiche).Cells(45, 11) = Sheets(Nom_Temp).Cells(I, 83)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 11) = (Sheets(Nom_Temp).Cells(I, 83) / Sheets(Nom_Temp).Cells(I, 45)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 11) = Sheets(Nom_Temp).Cells(I, 83) / Sheets(Nom_Temp).Cells(I, 24)
        
        'S.VET FEMME
        'CA
        Sheets(Nom_Fiche).Cells(45, 16) = Sheets(Nom_Temp).Cells(I, 82)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 16) = (Sheets(Nom_Temp).Cells(I, 82) / Sheets(Nom_Temp).Cells(I, 44)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 16) = Sheets(Nom_Temp).Cells(I, 82) / Sheets(Nom_Temp).Cells(I, 24)
        
        'S.VET ENFANT
        'CA
        Sheets(Nom_Fiche).Cells(45, 21) = Sheets(Nom_Temp).Cells(I, 81)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 21) = (Sheets(Nom_Temp).Cells(I, 81) / Sheets(Nom_Temp).Cells(I, 43)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 21) = Sheets(Nom_Temp).Cells(I, 81) / Sheets(Nom_Temp).Cells(I, 24)
        
        'S.VET LAYETTE
        'CA
        Sheets(Nom_Fiche).Cells(45, 26) = Sheets(Nom_Temp).Cells(I, 80)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 26) = (Sheets(Nom_Temp).Cells(I, 80) / Sheets(Nom_Temp).Cells(I, 42)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 26) = Sheets(Nom_Temp).Cells(I, 80) / Sheets(Nom_Temp).Cells(I, 24)
        
        'CHAUSSETTES
        'CA
        Sheets(Nom_Fiche).Cells(45, 31) = Sheets(Nom_Temp).Cells(I, 84)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 31) = (Sheets(Nom_Temp).Cells(I, 84) / Sheets(Nom_Temp).Cells(I, 46)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 31) = Sheets(Nom_Temp).Cells(I, 84) / Sheets(Nom_Temp).Cells(I, 24)
        
        'COLLANTS
        'CA
        Sheets(Nom_Fiche).Cells(45, 36) = Sheets(Nom_Temp).Cells(I, 89)
        'Evol CA
        Sheets(Nom_Fiche).Cells(46, 36) = (Sheets(Nom_Temp).Cells(I, 89) / Sheets(Nom_Temp).Cells(I, 51)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(47, 36) = Sheets(Nom_Temp).Cells(I, 89) / Sheets(Nom_Temp).Cells(I, 24)
        
        
        
        
        '-----------------------------------------
        'GROUPE EQUIPEMENT
        '-----------------------------------------
        'GROUPE EQUIPEMENT
        'CA
        Sheets(Nom_Fiche).Cells(70, 6) = Sheets(Nom_Temp).Cells(I, 66)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 6) = (Sheets(Nom_Temp).Cells(I, 66) / Sheets(Nom_Temp).Cells(I, 28)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(72, 6) = Sheets(Nom_Temp).Cells(I, 66) / Sheets(Nom_Temp).Cells(I, 24)
        
        'LDM
        'CA
        Sheets(Nom_Fiche).Cells(70, 11) = Sheets(Nom_Temp).Cells(I, 92)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 11) = (Sheets(Nom_Temp).Cells(I, 92) / Sheets(Nom_Temp).Cells(I, 54)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(72, 11) = Sheets(Nom_Temp).Cells(I, 92) / Sheets(Nom_Temp).Cells(I, 24)
        
        'PUERICULTURE
        'CA
        Sheets(Nom_Fiche).Cells(70, 16) = Sheets(Nom_Temp).Cells(I, 95)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 16) = (Sheets(Nom_Temp).Cells(I, 95) / Sheets(Nom_Temp).Cells(I, 57)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(72, 16) = Sheets(Nom_Temp).Cells(I, 95) / Sheets(Nom_Temp).Cells(I, 24)
        
        'ACCESSOIRES
        'CA
        Sheets(Nom_Fiche).Cells(70, 21) = Sheets(Nom_Temp).Cells(I, 98)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 21) = (Sheets(Nom_Temp).Cells(I, 98) / Sheets(Nom_Temp).Cells(I, 60)) - 1
        'Quota CA&
        Sheets(Nom_Fiche).Cells(72, 21) = Sheets(Nom_Temp).Cells(I, 98) / Sheets(Nom_Temp).Cells(I, 24)
        
        'CHAUSSURES EXT.
        'CA
        Sheets(Nom_Fiche).Cells(70, 26) = Sheets(Nom_Temp).Cells(I, 99)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 26) = (Sheets(Nom_Temp).Cells(I, 99) / Sheets(Nom_Temp).Cells(I, 61)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(72, 26) = Sheets(Nom_Temp).Cells(I, 99) / Sheets(Nom_Temp).Cells(I, 24)
        
        'CHAUSSURES INT.
        'CA
        Sheets(Nom_Fiche).Cells(70, 31) = Sheets(Nom_Temp).Cells(I, 100)
        'Evol CA
        Sheets(Nom_Fiche).Cells(71, 31) = (Sheets(Nom_Temp).Cells(I, 100) / Sheets(Nom_Temp).Cells(I, 62)) - 1
        'Quota CA
        Sheets(Nom_Fiche).Cells(72, 31) = Sheets(Nom_Temp).Cells(I, 100) / Sheets(Nom_Temp).Cells(I, 24)
 
    End If
Next I

Call Univers_Comparaison

End Sub


Sub Graph_VETDESSUS()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Temp As String, Nom_Fiche As String, Nom_Graph As String

Nom_Temp = "TEMP_FICHE2"
Nom_Fiche = "FICHE2"
Nom_Graph = "GRAPH_FICHE2"

Sheets(Nom_Temp).Activate
ligne = Sheets("BASE").Range("A200000").End(xlUp).Row

'Nb Mag Univers et Tiers
    Nb_PDV_Univ = Application.WorksheetFunction.Subtotal(3, Range(Cells(2, 1), Cells(ligne, 1)))
    Nb_PDV_Tiers = Fix(Nb_PDV_Univ / 3)

    
    
'---------------------------------------------------------------------
'Tri 1 sur le CA VET DU DESSUS
'---------------------------------------------------------------------

    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BL1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 64), Cells(ligne, 64))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 64), Cells(ligne, 64)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 64), Cells(2 + Nb_PDV_Tiers - 1, 64))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 64), Cells(2 + Nb_PDV_Tiers - 1, 64)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 64) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 64), Cells(ligne, 64)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 6)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 64), Cells(ligne, 64))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 26), Cells(ligne, 26)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 64), Cells(2 + Nb_PDV_Tiers - 1, 64))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 26), Cells(2 + Nb_PDV_Tiers - 1, 26)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 7) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 8) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 8) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 8) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 7) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 8) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 8) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 8) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 7) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 8) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 8) = "-"
                    Sheets(Nom_Fiche).Cells(20, 8) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 2) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 3) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 4) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 5) = Quota_Max_Univ
    Next I
    

'---------------------------------------------------------------------
'Tri 2 sur le CA VET HOMME
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BR1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 70), Cells(ligne, 70))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 70), Cells(ligne, 70)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 70), Cells(2 + Nb_PDV_Tiers - 1, 70))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 70), Cells(2 + Nb_PDV_Tiers - 1, 70)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 70) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 70), Cells(ligne, 70)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 11)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 70), Cells(ligne, 70))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 32), Cells(ligne, 32)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 70), Cells(2 + Nb_PDV_Tiers - 1, 70))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 32), Cells(2 + Nb_PDV_Tiers - 1, 32)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 12) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 13) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 13) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 13) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 12) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 13) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 13) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 13) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 12) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 13) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 13) = "-"
                    Sheets(Nom_Fiche).Cells(20, 13) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 6) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 7) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 8) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 9) = Quota_Max_Univ
    Next I
    
    
'---------------------------------------------------------------------
'Tri 3 sur le CA VET FEMME
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BQ1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 69), Cells(ligne, 69))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 69), Cells(ligne, 69)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 69), Cells(2 + Nb_PDV_Tiers - 1, 69))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 69), Cells(2 + Nb_PDV_Tiers - 1, 69)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 69) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 69), Cells(ligne, 69)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 16)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 69), Cells(ligne, 69))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 31), Cells(ligne, 31)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 69), Cells(2 + Nb_PDV_Tiers - 1, 69))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 31), Cells(2 + Nb_PDV_Tiers - 1, 31)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 17) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 18) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 18) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 18) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 17) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 18) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 18) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 18) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 17) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 18) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 18) = "-"
                    Sheets(Nom_Fiche).Cells(20, 18) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 10) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 11) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 12) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 13) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 4 sur le CA VET ENFANT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BP1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 68), Cells(ligne, 68))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 68), Cells(ligne, 68)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 68), Cells(2 + Nb_PDV_Tiers - 1, 68))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 68), Cells(2 + Nb_PDV_Tiers - 1, 68)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 68) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 68), Cells(ligne, 68)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 21)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 68), Cells(ligne, 68))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 30), Cells(ligne, 30)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 68), Cells(2 + Nb_PDV_Tiers - 1, 68))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 30), Cells(2 + Nb_PDV_Tiers - 1, 30)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 22) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 23) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 23) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 23) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 22) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 23) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 23) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 23) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 22) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 23) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 23) = "-"
                    Sheets(Nom_Fiche).Cells(20, 18) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 14) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 15) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 16) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 17) = Quota_Max_Univ
    Next I
    

'---------------------------------------------------------------------
'Tri 5 sur le CA VET LAYETTE
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BO1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 67), Cells(ligne, 67))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 67), Cells(ligne, 67)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 67), Cells(2 + Nb_PDV_Tiers - 1, 67))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 67), Cells(2 + Nb_PDV_Tiers - 1, 67)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 67) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 67), Cells(ligne, 67)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 26)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 67), Cells(ligne, 67))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 29), Cells(ligne, 29)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 67), Cells(2 + Nb_PDV_Tiers - 1, 67))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 29), Cells(2 + Nb_PDV_Tiers - 1, 29)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 27) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 28) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 28) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 28) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 27) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 28) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 28) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 28) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 27) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 28) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 28) = "-"
                    Sheets(Nom_Fiche).Cells(20, 18) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 18) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 19) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 20) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 21) = Quota_Max_Univ
    Next I
    
    
    
'---------------------------------------------------------------------
'Tri 6 sur le CA NUIT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BS1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 71), Cells(ligne, 71))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 71), Cells(ligne, 71)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 71), Cells(2 + Nb_PDV_Tiers - 1, 71))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 71), Cells(2 + Nb_PDV_Tiers - 1, 71)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 71) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 67), Cells(ligne, 67)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 31)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 71), Cells(ligne, 71))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 33), Cells(ligne, 33)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 71), Cells(2 + Nb_PDV_Tiers - 1, 71))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 33), Cells(2 + Nb_PDV_Tiers - 1, 33)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 32) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 33) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 33) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 33) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 32) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 33) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 33) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 33) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 32) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 33) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 33) = "-"
                    Sheets(Nom_Fiche).Cells(20, 33) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 22) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 23) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 24) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 25) = Quota_Max_Univ
    Next I
    
    

'---------------------------------------------------------------------
'Tri 7 sur le CA BAIN
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BW1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 75), Cells(ligne, 75))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 75), Cells(ligne, 75)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 75), Cells(2 + Nb_PDV_Tiers - 1, 75))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 75), Cells(2 + Nb_PDV_Tiers - 1, 75)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 75) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 75), Cells(ligne, 75)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(22, 36)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 75), Cells(ligne, 75))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 37), Cells(ligne, 37)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 71), Cells(2 + Nb_PDV_Tiers - 1, 71))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 37), Cells(2 + Nb_PDV_Tiers - 1, 37)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(19, 37) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(22, 38) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(21, 38) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(20, 38) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(19, 37) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(22, 38) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(21, 38) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(20, 38) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(19, 37) = "Maximum"
                    Sheets(Nom_Fiche).Cells(22, 38) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(21, 38) = "-"
                    Sheets(Nom_Fiche).Cells(20, 38) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 26) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 27) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 28) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 29) = Quota_Max_Univ
    Next I
    
End Sub


Sub Graph_VETDESSOUS()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Temp As String, Nom_Fiche As String, Nom_Graph As String

Nom_Temp = "TEMP_FICHE2"
Nom_Fiche = "FICHE2"
Nom_Graph = "GRAPH_FICHE2"

Sheets(Nom_Temp).Activate
ligne = Sheets("BASE").Range("A200000").End(xlUp).Row

'Nb Mag Univers et Tiers
    Nb_PDV_Univ = Application.WorksheetFunction.Subtotal(3, Range(Cells(8, 1), Cells(ligne, 1)))
    Nb_PDV_Tiers = Fix(Nb_PDV_Univ / 3)
    
    
'---------------------------------------------------------------------
'Tri 8 sur le VET DU DESSOUS
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BM1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 65), Cells(ligne, 65))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 65), Cells(ligne, 65)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 65), Cells(2 + Nb_PDV_Tiers - 1, 65))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 65), Cells(2 + Nb_PDV_Tiers - 1, 65)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 65) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 65), Cells(ligne, 65)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 6)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 65), Cells(ligne, 65))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 27), Cells(ligne, 27)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 65), Cells(2 + Nb_PDV_Tiers - 1, 65))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 27), Cells(2 + Nb_PDV_Tiers - 1, 27)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 7) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 8) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 8) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 8) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 7) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 8) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 8) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 8) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 7) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 8) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 8) = "-"
                    Sheets(Nom_Fiche).Cells(45, 8) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 30) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 31) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 32) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 33) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 9 sur le S.VET HOMME
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CE1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 83), Cells(ligne, 83))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 83), Cells(ligne, 83)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 83), Cells(2 + Nb_PDV_Tiers - 1, 83))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 83), Cells(2 + Nb_PDV_Tiers - 1, 83)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 83) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 83), Cells(ligne, 83)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 11)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 83), Cells(ligne, 83))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 45), Cells(ligne, 45)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 83), Cells(2 + Nb_PDV_Tiers - 1, 83))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 45), Cells(2 + Nb_PDV_Tiers - 1, 45)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 12) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 13) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 13) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 13) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 12) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 13) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 13) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 13) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 12) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 13) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 13) = "-"
                    Sheets(Nom_Fiche).Cells(45, 13) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 34) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 35) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 36) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 37) = Quota_Max_Univ
    Next I



'---------------------------------------------------------------------
'Tri 10 sur le S.VET FEMME
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CD1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 82), Cells(ligne, 82))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 82), Cells(ligne, 82)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 82), Cells(2 + Nb_PDV_Tiers - 1, 82))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 82), Cells(2 + Nb_PDV_Tiers - 1, 82)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 82) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 82), Cells(ligne, 82)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 16)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 82), Cells(ligne, 82))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 44), Cells(ligne, 44)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 82), Cells(2 + Nb_PDV_Tiers - 1, 82))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 44), Cells(2 + Nb_PDV_Tiers - 1, 44)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 17) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 18) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 18) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 18) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 17) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 18) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 18) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 18) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 17) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 18) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 18) = "-"
                    Sheets(Nom_Fiche).Cells(45, 18) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 38) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 39) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 40) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 41) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 11 sur le S.VET ENFANT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CC1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 81), Cells(ligne, 81))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 81), Cells(ligne, 81)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 81), Cells(2 + Nb_PDV_Tiers - 1, 81))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 81), Cells(2 + Nb_PDV_Tiers - 1, 81)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 81) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 81), Cells(ligne, 81)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 21)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 81), Cells(ligne, 81))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 43), Cells(ligne, 43)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 81), Cells(2 + Nb_PDV_Tiers - 1, 81))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 43), Cells(2 + Nb_PDV_Tiers - 1, 43)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 22) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 23) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 23) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 23) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 22) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 23) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 23) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 23) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 22) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 23) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 23) = "-"
                    Sheets(Nom_Fiche).Cells(45, 23) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 42) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 43) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 44) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 45) = Quota_Max_Univ
    Next I
    
    
'---------------------------------------------------------------------
'Tri 12 sur le S.VET LAYETTE
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CB1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 80), Cells(ligne, 80))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 80), Cells(ligne, 80)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 80), Cells(2 + Nb_PDV_Tiers - 1, 80))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 80), Cells(2 + Nb_PDV_Tiers - 1, 80)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 80) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 80), Cells(ligne, 80)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 26)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 80), Cells(ligne, 80))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 42), Cells(ligne, 42)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 80), Cells(2 + Nb_PDV_Tiers - 1, 80))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 42), Cells(2 + Nb_PDV_Tiers - 1, 42)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 27) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 28) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 28) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 28) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 27) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 28) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 28) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 28) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 27) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 28) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 28) = "-"
                    Sheets(Nom_Fiche).Cells(45, 28) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 46) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 47) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 48) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 49) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 13 sur la CHAUSSETTE
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CF1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------
    
    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 84), Cells(ligne, 84))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 84), Cells(ligne, 84)))
    
    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 84), Cells(2 + Nb_PDV_Tiers - 1, 84))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 84), Cells(2 + Nb_PDV_Tiers - 1, 84)))
    
    'Quota et CA Max Univers
    
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 84) / Sheets(Nom_Temp).Cells(I, 24)
    Next I
    
    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 84), Cells(ligne, 84)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 31)
    
    '-------------------- EVOLUTIONS ------------------------------------------------------------
    
    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 84), Cells(ligne, 84))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 46), Cells(ligne, 46)))) - 1

    
    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 84), Cells(2 + Nb_PDV_Tiers - 1, 84))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 46), Cells(2 + Nb_PDV_Tiers - 1, 46)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 32) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 33) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 33) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 33) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 32) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 33) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 33) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 33) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 32) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 33) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 33) = "-"
                    Sheets(Nom_Fiche).Cells(45, 33) = CA_Max_Univ
    End If
    
    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 50) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 51) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 52) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 53) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 14 sur le COLLANT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CK1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 89), Cells(ligne, 89))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 89), Cells(ligne, 89)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 89), Cells(2 + Nb_PDV_Tiers - 1, 89))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 89), Cells(2 + Nb_PDV_Tiers - 1, 89)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 89) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 89), Cells(ligne, 89)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(47, 36)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 89), Cells(ligne, 89))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 51), Cells(ligne, 51)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 89), Cells(2 + Nb_PDV_Tiers - 1, 89))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 51), Cells(2 + Nb_PDV_Tiers - 1, 51)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(44, 37) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(47, 38) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(46, 38) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(45, 38) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(44, 37) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(47, 38) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(46, 38) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(45, 38) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(44, 37) = "Maximum"
                    Sheets(Nom_Fiche).Cells(47, 38) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(46, 38) = "-"
                    Sheets(Nom_Fiche).Cells(45, 38) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 54) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 55) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 56) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 57) = Quota_Max_Univ
    Next I

End Sub


Sub Graph_EQUIPEMENT()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Temp As String, Nom_Fiche As String, Nom_Graph As String

Nom_Temp = "TEMP_FICHE2"
Nom_Fiche = "FICHE2"
Nom_Graph = "GRAPH_FICHE2"

Sheets(Nom_Temp).Activate
ligne = Sheets("BASE").Range("A200000").End(xlUp).Row

'Nb Mag Univers et Tiers
    Nb_PDV_Univ = Application.WorksheetFunction.Subtotal(3, Range(Cells(8, 1), Cells(ligne, 1)))
    Nb_PDV_Tiers = Fix(Nb_PDV_Univ / 3)
    

'---------------------------------------------------------------------
'Tri 16 sur l EQUIPEMENT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("BN1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 66), Cells(ligne, 66))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 66), Cells(ligne, 66)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 66), Cells(2 + Nb_PDV_Tiers - 1, 66))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 66), Cells(2 + Nb_PDV_Tiers - 1, 66)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 66) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 66), Cells(ligne, 66)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 6)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 66), Cells(ligne, 66))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 28), Cells(ligne, 28)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 66), Cells(2 + Nb_PDV_Tiers - 1, 66))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 28), Cells(2 + Nb_PDV_Tiers - 1, 28)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 7) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 8) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 8) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 8) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 7) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 8) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 8) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 8) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 7) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 8) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 8) = "-"
                    Sheets(Nom_Fiche).Cells(70, 8) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 58) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 59) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 60) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 61) = Quota_Max_Univ
    Next I

'---------------------------------------------------------------------
'Tri 17 sur le LDM
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CN1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 92), Cells(ligne, 92))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 92), Cells(ligne, 92)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 92), Cells(2 + Nb_PDV_Tiers - 1, 92))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 92), Cells(2 + Nb_PDV_Tiers - 1, 92)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 92) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 92), Cells(ligne, 92)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 11)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 92), Cells(ligne, 92))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 54), Cells(ligne, 54)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 92), Cells(2 + Nb_PDV_Tiers - 1, 92))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 54), Cells(2 + Nb_PDV_Tiers - 1, 54)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 12) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 13) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 13) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 13) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 12) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 13) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 13) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 13) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 12) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 13) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 13) = "-"
                    Sheets(Nom_Fiche).Cells(70, 13) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 62) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 63) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 64) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 65) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 18 sur la PUERICULTURE
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CQ1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 95), Cells(ligne, 95))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 95), Cells(ligne, 95)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 95), Cells(2 + Nb_PDV_Tiers - 1, 95))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 95), Cells(2 + Nb_PDV_Tiers - 1, 95)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 95) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 95), Cells(ligne, 95)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 16)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 95), Cells(ligne, 95))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 57), Cells(ligne, 57)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 95), Cells(2 + Nb_PDV_Tiers - 1, 95))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 57), Cells(2 + Nb_PDV_Tiers - 1, 57)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 17) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 18) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 18) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 18) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 17) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 18) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 18) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 18) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 17) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 18) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 18) = "-"
                    Sheets(Nom_Fiche).Cells(70, 18) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 66) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 67) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 68) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 69) = Quota_Max_Univ
    Next I



'---------------------------------------------------------------------
'Tri 19 sur les ACCESSOIRES
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CT1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 98), Cells(ligne, 98))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 98), Cells(ligne, 98)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 98), Cells(2 + Nb_PDV_Tiers - 1, 98))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 98), Cells(2 + Nb_PDV_Tiers - 1, 98)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 98) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 98), Cells(ligne, 98)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 21)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 98), Cells(ligne, 98))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 60), Cells(ligne, 60)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 98), Cells(2 + Nb_PDV_Tiers - 1, 98))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 60), Cells(2 + Nb_PDV_Tiers - 1, 60)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 22) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 23) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 23) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 23) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 22) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 23) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 23) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 23) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 22) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 23) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 23) = "-"
                    Sheets(Nom_Fiche).Cells(70, 23) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 70) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 71) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 72) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 73) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 19 sur la CHAUSSURE EXT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CU1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 99), Cells(ligne, 99))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 99), Cells(ligne, 99)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 99), Cells(2 + Nb_PDV_Tiers - 1, 99))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 99), Cells(2 + Nb_PDV_Tiers - 1, 99)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 99) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 99), Cells(ligne, 99)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 26)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 99), Cells(ligne, 99))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 61), Cells(ligne, 61)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 99), Cells(2 + Nb_PDV_Tiers - 1, 99))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 61), Cells(2 + Nb_PDV_Tiers - 1, 61)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 27) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 28) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 28) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 28) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 27) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 28) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 28) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 28) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 27) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 28) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 28) = "-"
                    Sheets(Nom_Fiche).Cells(70, 28) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 74) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 75) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 76) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 77) = Quota_Max_Univ
    Next I


'---------------------------------------------------------------------
'Tri 20 sur la CHAUSSURE INT
'---------------------------------------------------------------------
    Columns(102).ClearContents
    Columns("A:CW").Select
    Selection.Sort Key1:=Range("CV1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers

    '-------------------- QUOTAS ------------------------------------------------------------

    'Quota et CA Moyen Univers
    Quota_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 100), Cells(ligne, 100))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(ligne, 24)))
    CA_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 100), Cells(ligne, 100)))

    'Quota et CA Tiers Univers
    Quota_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 100), Cells(2 + Nb_PDV_Tiers - 1, 100))) / Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 24), Cells(2 + Nb_PDV_Tiers - 1, 24)))
    CA_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 100), Cells(2 + Nb_PDV_Tiers - 1, 100)))

    'Quota et CA Max Univers

    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        Sheets(Nom_Temp).Cells(I, 102) = Sheets(Nom_Temp).Cells(I, 100) / Sheets(Nom_Temp).Cells(I, 24)
    Next I

    Quota_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 102), Cells(ligne, 102)))
    CA_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 100), Cells(ligne, 100)))

    'Recup Quota RAYON du PDV
    Quota_Mag = Sheets(Nom_Fiche).Cells(72, 31)

    '-------------------- EVOLUTIONS ------------------------------------------------------------

    'Evol CA Moyen Univers
    Evol_CA_Moyen_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 100), Cells(ligne, 100))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 62), Cells(ligne, 62)))) - 1


    'Evol CA Tiers Univers
    Evol_CA_Tiers_Univ = (Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 100), Cells(2 + Nb_PDV_Tiers - 1, 100))) / Application.WorksheetFunction.Subtotal(9, Range(Cells(2, 62), Cells(2 + Nb_PDV_Tiers - 1, 62)))) - 1


    'Conditionnelle pour Quota ‡ afficher Moyen/Tiers/Max
    If Quota_Mag < Quota_Moy_Univ Then
        Sheets(Nom_Fiche).Cells(69, 32) = "Moyenne Univers"
        Sheets(Nom_Fiche).Cells(72, 33) = Quota_Moy_Univ
        Sheets(Nom_Fiche).Cells(71, 33) = Evol_CA_Moyen_Univ
        Sheets(Nom_Fiche).Cells(70, 33) = CA_Moy_Univ
        ElseIf Quota_Mag < Quota_Tiers_Univ Then
            Sheets(Nom_Fiche).Cells(69, 32) = "Tiers du haut"
            Sheets(Nom_Fiche).Cells(72, 33) = Quota_Tiers_Univ
            Sheets(Nom_Fiche).Cells(71, 33) = Evol_CA_Tiers_Univ
            Sheets(Nom_Fiche).Cells(70, 33) = CA_Tiers_Univ
                Else
                    Sheets(Nom_Fiche).Cells(69, 32) = "Maximum"
                    Sheets(Nom_Fiche).Cells(72, 33) = Quota_Max_Univ
                    Sheets(Nom_Fiche).Cells(71, 33) = "-"
                    Sheets(Nom_Fiche).Cells(70, 33) = CA_Max_Univ
    End If

    'Remplissage TEMP_GRAPH partie Vet du dessus
    For I = 3 To 35
        Sheets(Nom_Graph).Cells(I, 78) = Quota_Mag
        Sheets(Nom_Graph).Cells(I, 79) = Quota_Moy_Univ
        Sheets(Nom_Graph).Cells(I, 80) = Quota_Tiers_Univ
        Sheets(Nom_Graph).Cells(I, 81) = Quota_Max_Univ
    Next I

End Sub


Sub Feu_Rouge_Orange_Vert()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Temp As String, Nom_Fiche As String

Nom_Temp = "TEMP_FICHE2"
Nom_Fiche = "FICHE2"

'SECTEUR VET DU DESSUS
Select Case Sheets(Nom_Fiche).Cells(21, 6)
    Case Is < -0.054: Sheets(Nom_Fiche).Cells(21, 5) = 3
    Case -0.054 To -0.028: Sheets(Nom_Fiche).Cells(21, 5) = 2
    Case Is >= -0.028: Sheets(Nom_Fiche).Cells(21, 5) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 7)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 5) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 5) = 1
End Select


'RAYON VET HOMME
Select Case Sheets(Nom_Fiche).Cells(21, 11)
    Case Is < -0.021: Sheets(Nom_Fiche).Cells(21, 10) = 3
    'Case -0.021 To 0.0028: Sheets(Nom_Fiche).Cells(21, 10) = 2
    Case Is >= -0.021: Sheets(Nom_Fiche).Cells(21, 10) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 12)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 10) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 10) = 1
End Select


'RAYON VET FEMME
Select Case Sheets(Nom_Fiche).Cells(21, 16)
    Case Is < -0.037: Sheets(Nom_Fiche).Cells(21, 15) = 3
    Case -0.037 To 0.022: Sheets(Nom_Fiche).Cells(21, 15) = 2
    Case Is >= 0.022: Sheets(Nom_Fiche).Cells(21, 15) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 17)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 15) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 15) = 1
End Select


'RAYON VET ENFANT
Select Case Sheets(Nom_Fiche).Cells(21, 21)
    Case Is < -0.143: Sheets(Nom_Fiche).Cells(21, 20) = 3
    Case -0.143 To -0.022: Sheets(Nom_Fiche).Cells(21, 20) = 2
    Case Is >= -0.022: Sheets(Nom_Fiche).Cells(21, 20) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 22)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 20) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 20) = 1
End Select


'RAYON VET LAYETTE
Select Case Sheets(Nom_Fiche).Cells(21, 26)
    Case Is < -0.143: Sheets(Nom_Fiche).Cells(21, 25) = 3
    Case -0.143 To -0.022: Sheets(Nom_Fiche).Cells(21, 25) = 2
    Case Is >= -0.022: Sheets(Nom_Fiche).Cells(21, 25) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 27)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 25) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 25) = 1
End Select


'RAYON NUIT
Select Case Sheets(Nom_Fiche).Cells(21, 31)
    Case Is < 0: Sheets(Nom_Fiche).Cells(21, 30) = 3
    Case 0 To 0.016: Sheets(Nom_Fiche).Cells(21, 30) = 2
    Case Is >= 0.016: Sheets(Nom_Fiche).Cells(21, 30) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 32)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 30) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 30) = 1
End Select


'RAYON BAIN
Select Case Sheets(Nom_Fiche).Cells(21, 36)
    Case Is < -0.139: Sheets(Nom_Fiche).Cells(21, 35) = 3
    Case Is >= -0.139: Sheets(Nom_Fiche).Cells(21, 35) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(19, 37)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(22, 35) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(22, 35) = 1
End Select


'***********************************************************************
'SECTEUR VET DU DESSOUS
Select Case Sheets(Nom_Fiche).Cells(46, 6)
    Case Is < -0.043: Sheets(Nom_Fiche).Cells(46, 5) = 3
    Case -0.043 To -0.028: Sheets(Nom_Fiche).Cells(46, 5) = 2
    Case Is >= -0.028: Sheets(Nom_Fiche).Cells(46, 5) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 7)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 5) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 5) = 1
End Select


'RAYON S.VET HOMME
Select Case Sheets(Nom_Fiche).Cells(46, 11)
    Case Is < -0.043: Sheets(Nom_Fiche).Cells(46, 10) = 3
    Case Is >= -0.043: Sheets(Nom_Fiche).Cells(46, 10) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 12)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 10) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 10) = 1
End Select


'RAYON S.VET FEMME
Select Case Sheets(Nom_Fiche).Cells(46, 16)
    Case Is < -0.015: Sheets(Nom_Fiche).Cells(46, 15) = 3
    Case Is >= 0.015: Sheets(Nom_Fiche).Cells(46, 15) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 17)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 15) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 15) = 1
End Select


'RAYON S.VET ENFANT
Select Case Sheets(Nom_Fiche).Cells(46, 21)
    Case Is < -0.067: Sheets(Nom_Fiche).Cells(46, 20) = 3
    Case -0.067 To -0.06: Sheets(Nom_Fiche).Cells(46, 20) = 2
    Case Is >= -0.06: Sheets(Nom_Fiche).Cells(46, 20) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 22)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 20) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 20) = 1
End Select


'RAYON S.VET LAYETTE
Select Case Sheets(Nom_Fiche).Cells(46, 26)
    Case Is < -0.081: Sheets(Nom_Fiche).Cells(46, 25) = 3
    Case -0.081 To -0.06: Sheets(Nom_Fiche).Cells(46, 25) = 2
    Case Is >= -0.06: Sheets(Nom_Fiche).Cells(46, 25) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 27)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 25) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 25) = 1
End Select


'RAYON CHAUSSETTES
Select Case Sheets(Nom_Fiche).Cells(46, 31)
    Case Is < -0.053: Sheets(Nom_Fiche).Cells(46, 30) = 3
    Case -0.053 To -0.037: Sheets(Nom_Fiche).Cells(46, 30) = 2
    Case Is >= 0.016: Sheets(Nom_Fiche).Cells(46, 30) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 32)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 30) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 30) = 1
End Select


'RAYON COLLANTS
Select Case Sheets(Nom_Fiche).Cells(46, 36)
    Case Is < -0.075: Sheets(Nom_Fiche).Cells(46, 35) = 3
    Case Is >= -0.075: Sheets(Nom_Fiche).Cells(46, 35) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(44, 37)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(47, 35) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(47, 35) = 1
End Select




'***********************************************************************
'EQUIPEMENT
Select Case Sheets(Nom_Fiche).Cells(71, 6)
    Case Is < -0.025: Sheets(Nom_Fiche).Cells(71, 5) = 3
    Case Is >= -0.025: Sheets(Nom_Fiche).Cells(71, 5) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 7)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 5) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 5) = 1
End Select



'LDM
Select Case Sheets(Nom_Fiche).Cells(71, 11)
    Case Is < -0.015: Sheets(Nom_Fiche).Cells(71, 10) = 3
    Case Is >= -0.015: Sheets(Nom_Fiche).Cells(71, 10) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 12)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 10) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 10) = 1
End Select



'PUERICULTURE
Select Case Sheets(Nom_Fiche).Cells(71, 16)
    Case Is < -0.083: Sheets(Nom_Fiche).Cells(71, 15) = 3
    Case -0.083 To -0.073: Sheets(Nom_Fiche).Cells(71, 15) = 2
    Case Is >= -0.073: Sheets(Nom_Fiche).Cells(71, 15) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 17)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 15) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 15) = 1
End Select



'ACCESSOIRES
Select Case Sheets(Nom_Fiche).Cells(71, 21)
    Case Is < -0.023: Sheets(Nom_Fiche).Cells(71, 20) = 3
    Case -0.023 To -0.005: Sheets(Nom_Fiche).Cells(71, 20) = 2
    Case Is >= -0.005: Sheets(Nom_Fiche).Cells(71, 20) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 22)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 20) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 20) = 1
End Select


'CHAUSS EXT
Select Case Sheets(Nom_Fiche).Cells(71, 26)
    Case Is < -0.095: Sheets(Nom_Fiche).Cells(71, 25) = 3
    Case Is >= -0.095: Sheets(Nom_Fiche).Cells(71, 25) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 27)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 25) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 25) = 1
End Select


'CHAUSS INT
Select Case Sheets(Nom_Fiche).Cells(71, 31)
    Case Is < -0.028: Sheets(Nom_Fiche).Cells(71, 30) = 3
    Case Is >= -0.028: Sheets(Nom_Fiche).Cells(71, 30) = 1
End Select

Select Case Sheets(Nom_Fiche).Cells(69, 32)
    Case "Moyenne Univers": Sheets(Nom_Fiche).Cells(72, 30) = 3
    Case "Tiers du haut", "Maximum": Sheets(Nom_Fiche).Cells(72, 30) = 1
End Select

End Sub

Sub Routine_Fiche3(ByVal Groupe As String, ByVal Nom_PDV As String)

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Nom_Feuille As String, Nom_Temp As String, Nom_Temp_Bis As String, Nom_Fiche As String, Nom_Graph As String
Dim ligne As Long, Nb_PDV_Tiers As Integer, Nb_PDV_Univ As Integer
Dim CA_Bijout As Double, CA_Bijout_Moy_Univ As Double, CA_Bijout_Tiers_Univ As Double, CA_Bijout_Max_Univ As Double
Dim CA_Beeline As Double, CA_Beeline_Moy_Univ As Double, CA_Beeline_Tiers_Univ As Double, CA_Beeline_Max_Univ As Double
Dim CA_Beeline_12m As Double, CA_Beeline_Moy_Univ_12m As Double, CA_Beeline_Tiers_Univ_12m As Double, CA_Beeline_Max_Univ_12m As Double
Dim CA_Beeline_Moy_Univ_12m_Opti As Double, CA_Beeline_Tiers_Univ_12m_Opti As Double
Dim Zone As Integer, Tour_Enf As String, Nb_Mois As Integer
Dim Beeline As Boolean, Beeline_Groupe As Boolean
Dim LF As Range

Nom_Feuille = "BASE"
Nom_Temp = "TEMP_FICHE3"
Nom_Temp_Bis = "TEMP_FICHE3Bis"
Nom_Fiche = "FICHE3"
Nom_Graph = "GRAPH_FICHE3"
Beeline = False
Beeline_Groupe = False

ligne = 0: Mag_tiers = 0

Sheets(Nom_Feuille).Activate
ligne = Sheets(Nom_Feuille).Range("A200000").End(xlUp).Row

'Enseigne PDV

For I = 8 To Sheets(Nom_Feuille).Range("A1000000").End(xlUp).Row
    If Sheets(Nom_Feuille).Cells(I, 3) Like Nom_PDV Then
        enseigne = Sheets(Nom_Feuille).Cells(I, 4)
    End If
Next I


'Effacement de l'onglet TEMP
    Sheets(Nom_Temp).Range("A1:ZZ20000").ClearContents

'Filtre dans BASE sur "Groupe" et copie dans l'onglet TEMP
    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).[A7].AutoFilter Field:=20, Criteria1:=Groupe
    
    Set LF = Sheets(Nom_Feuille).Range(Cells(7, 1), Cells(ligne, 200)).SpecialCells(xlCellTypeVisible)
    LF.Copy
    Sheets(Nom_Temp).Activate
    Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Goto Range("A1")

    Sheets(Nom_Feuille).Activate
    Sheets(Nom_Feuille).ShowAllData
    
'Nb Mag Univers et Tiers
    Sheets(Nom_Temp).Activate
    Nb_PDV_Univ = Application.WorksheetFunction.Subtotal(3, Range(Cells(2, 106), Cells(ligne, 106)))
    Nb_PDV_Tiers = Fix(Nb_PDV_Univ / 3)


'Test si au moins 1 PDV fait BEELINE dans le Groupe
If Application.CountA(Application.CountA(Range(Cells(2, 106), Cells(ligne, 106)))) > 0 Then
    Beeline_Groupe = True
End If
    
'CA du PDV
    For I = 2 To Sheets(Nom_Temp).Range("A200000").End(xlUp).Row
        If Sheets(Nom_Temp).Cells(I, 3) Like Nom_PDV Then
            CA_Bijout = Sheets(Nom_Temp).Cells(I, 101)
            If Sheets(Nom_Temp).Cells(I, 102) <> "" Then: Beeline = True
        End If
        
        If Sheets(Nom_Temp).Cells(I, 3) Like Nom_PDV And Beeline = True Then
            CA_Beeline = Sheets(Nom_Temp).Cells(I, 105)
            CA_Beeline_12m = Sheets(Nom_Temp).Cells(I, 106)
            Zone = Sheets(Nom_Temp).Cells(I, 102)
            Tour_Enf = Sheets(Nom_Temp).Cells(I, 103)
            Nb_Mois = Sheets(Nom_Temp).Cells(I, 104)
        End If
    Next I

'CA Moyen et Max Univers
    CA_Bijout_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 101), Cells(ligne, 101)))
    CA_Bijout_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 101), Cells(ligne, 101)))
    
    CA_Beeline_Moy_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 105), Cells(ligne, 105)))
    CA_Beeline_Max_Univ = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 105), Cells(ligne, 105)))
    
    CA_Beeline_Moy_Univ_12m = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 106), Cells(ligne, 106)))
    CA_Beeline_Max_Univ_12m = Application.WorksheetFunction.Subtotal(4, Range(Cells(2, 106), Cells(ligne, 106)))


'CA Tiers du Haut Univers
  Columns("A:DB").Select
    Selection.Sort Key1:=Range("CW1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers
    CA_Bijout_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 101), Cells(2 + Nb_PDV_Tiers - 1, 101)))
    
  Columns("A:DB").Select
    Selection.Sort Key1:=Range("DA1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers
    CA_Beeline_Tiers_Univ = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 105), Cells(2 + Nb_PDV_Tiers - 1, 105)))
    
  Columns("A:DB").Select
    Selection.Sort Key1:=Range("DB1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers
    CA_Beeline_Tiers_Univ_12m = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 106), Cells(2 + Nb_PDV_Tiers - 1, 106)))


'Data pour Graph
'LE PDV FAIT BEELINE
If Beeline Then
'DATA PDV
    Sheets(Nom_Graph).Cells(3, 1) = "Mon CA 12 mois Beeline (Ä)"
    Sheets(Nom_Graph).Cells(4, 1) = CA_Beeline_12m 'En Euros
    Sheets(Nom_Graph).Cells(5, 1) = "Mon CA 12 mois Beeline (KÄ)"
    Sheets(Nom_Graph).Cells(6, 1) = CA_Beeline_12m / 1000 'En KEuros
'DATA CIBLE
'    If CA_Beeline_12m < CA_Beeline_Moy_Univ_12m Then
'        Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Moyenne Univers"
'        Sheets(Nom_Graph).Cells(4, 2) = CA_Beeline_Moy_Univ_12m 'En Euros
'        Sheets(Nom_Graph).Cells(6, 2) = CA_Beeline_Moy_Univ_12m / 1000  'En KEuros
'        ElseIf CA_Beeline_12m < CA_Beeline_Tiers_Univ_12m Then
'            Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Tiers du haut"
'            Sheets(Nom_Graph).Cells(4, 2) = CA_Beeline_Tiers_Univ_12m 'En Euros
'            Sheets(Nom_Graph).Cells(6, 2) = CA_Beeline_Tiers_Univ_12m / 1000 'En KEuros
'                Else
'                    Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Maximum"
'                    Sheets(Nom_Graph).Cells(4, 2) = CA_Beeline_Max_Univ_12mv
'                    Sheets(Nom_Graph).Cells(6, 2) = CA_Beeline_Max_Univ_12m / 1000 'En KEuros
        Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Maximum (Ä)"
        Sheets(Nom_Graph).Cells(4, 2) = CA_Beeline_Max_Univ_12m
        Sheets(Nom_Graph).Cells(5, 2) = "CA 12 mois Maximum (KÄ)"
        Sheets(Nom_Graph).Cells(6, 2) = CA_Beeline_Max_Univ_12m / 1000 'En KEuros
Else
'LE PDV NE FAIT PAS BEELINE
'DATA CIBLE
Sheets(Nom_Graph).Cells(3, 1) = ""
Sheets(Nom_Graph).Cells(4, 1) = ""
Sheets(Nom_Graph).Cells(5, 1) = ""
Sheets(Nom_Graph).Cells(6, 1) = ""

Select Case Beeline_Groupe
Case True
        Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Maximum (Ä)"
        Sheets(Nom_Graph).Cells(4, 2) = CA_Beeline_Max_Univ_12m
        Sheets(Nom_Graph).Cells(5, 2) = "CA 12 mois Maximum (KÄ)"
        Sheets(Nom_Graph).Cells(6, 2) = CA_Beeline_Max_Univ_12m / 1000 'En KEuros
Case False
    Select Case enseigne
        Case "Hyper U"
            Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Potentiel"
            Sheets(Nom_Graph).Cells(4, 2) = 31000 'En Euros
            Sheets(Nom_Graph).Cells(5, 2) = "CA 12 mois Maximum (KÄ)"
            Sheets(Nom_Graph).Cells(6, 2) = 31 'En KEuros
       Case "Super U"
            Sheets(Nom_Graph).Cells(3, 2) = "CA 12 mois Potentiel"
            Sheets(Nom_Graph).Cells(4, 2) = 28000 'En Euros
            Sheets(Nom_Graph).Cells(5, 2) = "CA 12 mois Maximum (KÄ)"
            Sheets(Nom_Graph).Cells(6, 2) = 28  'En KEuros
    End Select
End Select
End If



'PARTIE DROITE - ZONE OPTIMUM
''Effacement de l'onglet TEMP_FICHE3B
'Sheets(Nom_Temp_Bis).Range("A1:ZZ20000").ClearContents
'
''Construction de la base de PDV avec uniquement Zones 1 et 2 dans TEMP3B
'Sheets("BASE").Activate
'Sheets("BASE").[A7].AutoFilter Field:=102, Criteria1:="=1", Operator:=xlOr, Criteria2:="=2"
'
'Set LF = Sheets("BASE").Range(Cells(7, 1), Cells(2000, 200)).SpecialCells(xlCellTypeVisible)
'LF.Copy
'Sheets(Nom_Temp_Bis).Activate
'Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'Application.CutCopyMode = False
'Application.Goto Range("A1")
'
'Sheets("BASE").Activate
'Sheets("BASE").ShowAllData
'Sheets(Nom_Temp_Bis).Activate
    
'CA Moyen Beeline 12 mois Optimum Zones 1 et 2
'CA_Beeline_Moy_Univ_12m_Opti = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 106), Cells(Ligne, 106)))
'
''Nb Mag Univers et Tiers
'Nb_PDV_Univ = Application.WorksheetFunction.Subtotal(3, Range(Cells(2, 1), Cells(2000, 1)))
'Nb_PDV_Tiers = Fix(Nb_PDV_Univ / 3)
'
''CA Tiers du Haut Univers
'Columns("A:DB").Select
'Selection.Sort Key1:=Range("DB1"), Order1:=xlDescending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers
'CA_Beeline_Tiers_Univ_12m_Opti = Application.WorksheetFunction.Subtotal(1, Range(Cells(2, 106), Cells(2 + Nb_PDV_Tiers - 1, 106)))
'
'
'
''Affichage dans GRAPH FICHE3
''Si le PDV fait Beeline
''En Euros
'Sheets(Nom_Graph).Cells(11, 1) = CA_Beeline_Moy_Univ_12m_Opti
'Sheets(Nom_Graph).Cells(11, 2) = CA_Beeline_Tiers_Univ_12m_Opti
''En KEuros
'Sheets(Nom_Graph).Cells(13, 1) = CA_Beeline_Moy_Univ_12m_Opti / 1000
'Sheets(Nom_Graph).Cells(13, 2) = CA_Beeline_Tiers_Univ_12m_Opti / 1000


Application.Goto Range("A1")
End Sub

Sub Main()
    Application.StatusBar = "CONTACT : Adrien MÈchin - ChargÈ DÈveloppement des Ventes Textile"
    Call RAZ_bas_page
    Call Criteères
    If Sheets("FICHE1").Cells(1, 1) <> 1 Then
    Call Ranking_Textile
    Call Ranking_VDessus
    Call Ranking_VDessous
    Call Ranking_Equipement
    Call Objectif_Rang
    Call Affichage_evolution
    End If
End Sub

Sub Validation()
Dim test As Boolean
    test = Recherche_Code_Associe
    If test = True Then
        Call Caracteristiques_PDV
    End If
End Sub

Sub RAZ_All()
    Call RAZ_haut_page
    Call RAZ_bas_page
    Call RAZ_onglet_data_PDV
End Sub

Sub RAZ_haut_page()
    Call RAZ_Caract_PDV
    Call RAZ_CritËres
End Sub

Sub RAZ_onglet_data_PDV()
    Sheets("Data PDV").Range("A5:Z5").ClearContents
End Sub
Sub RAZ_Caract_PDV()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

Cells(13, 13) = ""

Cells(13, 36) = ""
Cells(14, 36) = ""
Cells(15, 36) = ""
Cells(16, 36) = ""
Cells(17, 36) = ""
Cells(18, 36) = ""
Cells(19, 36) = ""
Application.Goto Range("A1"), True


Sheets("Piliers du Textile").Range("W9:AF14,C8:I10,CA9:CJ14").ClearContents
Sheets("Piliers du Textile").Activate
Application.Goto Range("A1"), True

Sheets("FICHE1").Activate

End Sub


Sub RAZ_CritËres()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

Sheets("FICHE1").Cells(14, 85) = ""
Sheets("FICHE1").Cells(15, 85) = ""
Sheets("FICHE1").Cells(16, 85) = ""
Sheets("FICHE1").Cells(17, 85) = ""
Sheets("FICHE1").Cells(18, 85) = ""
Sheets("FICHE1").Cells(19, 85) = ""

Sheets("FICHE1").Cells(13, 80) = ""
Application.Goto Range("A1"), True
End Sub

Sub RAZ_bas_page()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

'RAZ indicateur dÈpassement univers
Cells(1, 1) = ""

Sheets("FICHE1").Activate
'RAZ Ranking
Range("A30:BZ59").ClearContents
Range("A64:BZ93").ClearContents
Range("A98:BZ127").ClearContents
Range("A132:BZ161").ClearContents
    
Range("A30:T59,AL30:BN59").Interior.Color = 16777215
Range("A64:AE93,AM64:BZ93").Interior.Color = 16777215
Range("A98:AD127,AK98:BZ127").Interior.Color = 16777215
Range("A132:AF161,AO132:BZ161").Interior.Color = 16777215

Range("A30:X59,AL30:BZ59").Borders(xlInsideHorizontal).LineStyle = xlNone
Range("A64:AE93,AM64:BZ93").Borders(xlInsideHorizontal).LineStyle = xlNone
Range("A98:AD127,AK98:BZ127").Borders(xlInsideHorizontal).LineStyle = xlNone
Range("A132:AF161,AO132:BZ161").Borders(xlInsideHorizontal).LineStyle = xlNone


'RAZ Obj gÈnÈral
    Cells(50, 91) = ""
    Cells(50, 96) = ""
    Cells(50, 101) = ""
    Cells(50, 106) = ""
    Cells(50, 111) = ""
    Cells(50, 116) = ""

    Cells(53, 91) = ""
    Cells(53, 96) = ""
    Cells(53, 101) = ""
    Cells(53, 106) = ""
    Cells(53, 111) = ""
    Cells(53, 116) = ""

    Cells(56, 91) = ""
    Cells(56, 96) = ""
    Cells(56, 101) = ""
    Cells(56, 106) = ""
    Cells(56, 111) = ""
    Cells(56, 116) = ""

'RAZ Obj Dessus
    Cells(72, 91) = ""
    Cells(71, 106) = 0
    Cells(75, 91) = ""
    Cells(74, 106) = 0
    Cells(78, 91) = ""
    Cells(77, 106) = 0
    Cells(81, 91) = ""
    Cells(80, 106) = 0
    Cells(84, 91) = ""
    Cells(83, 106) = 0
    Cells(87, 91) = ""
    Cells(86, 106) = 0

'RAZ Obj Dessous
    Cells(106, 91) = ""
    Cells(105, 106) = 0
    Cells(109, 91) = ""
    Cells(108, 106) = 0
    Cells(112, 91) = ""
    Cells(111, 106) = 0
    Cells(115, 91) = ""
    Cells(114, 106) = 0
    Cells(118, 91) = ""
    Cells(117, 106) = 0
    Cells(121, 91) = ""
    Cells(120, 106) = 0
    Cells(124, 91) = ""
    Cells(123, 106) = 0
    Cells(127, 91) = ""
    Cells(126, 106) = 0

'RAZ Obj Dessous
    Cells(142, 91) = ""
    Cells(141, 106) = 0
    Cells(145, 91) = ""
    Cells(144, 106) = 0
    Cells(148, 91) = ""
    Cells(147, 106) = 0
    Cells(151, 91) = ""
    Cells(150, 106) = 0
    Cells(154, 91) = ""
    Cells(153, 106) = 0
    
    
    
' Suppression des commentaires

    For I = 47 To 56
        Sheets("FICHE1").Cells(I, 85).ClearComments
        I = I + 2
    Next I
    
    For I = 69 To 87
        Sheets("FICHE1").Cells(I, 85).ClearComments
        I = I + 2
    Next I
    
    For I = 103 To 127
        Sheets("FICHE1").Cells(I, 85).ClearComments
        I = I + 2
    Next I
    
    For I = 139 To 154
        Sheets("FICHE1").Cells(I, 85).ClearComments
        I = I + 2
    Next I
        
Application.Goto Range("A1"), True

End Sub

Function Recherche_Code_Associe()
    Dim PDV As String, Reponse As String, Code_PDV As String
    Dim test As Boolean
    Reponse = ""
    
    Code_PDV = Sheets("FICHE1").Cells(12, 13)
    PDV = Sheets("FICHE1").Cells(13, 13)
    test = IsNumeric(PDV)
    
    If test = True Then
        Recherche_Code_Associe = True
        Exit Function
    End If
    
    PDV = UCase(PDV)

    For I = 2 To Sheets("BDD").Range("A900000").End(xlUp).Row
        If UCase(Sheets("BDD").Cells(I, 2)) Like "*" & PDV & "*" Then
            If Reponse = "" Then
                Reponse = Sheets("BDD").Cells(I, 1) & " - " & Sheets("BDD").Cells(I, 2)
                Else
                    Reponse = Reponse & Chr(10) & Sheets("BDD").Cells(I, 1) & " - " & Sheets("BDD").Cells(I, 2)
                    End If
        End If
    Next I
    Sheets("FICHE1").Cells(13, 13) = Code_PDV
    MsgBox (Reponse)
End Function


Sub Caracteristiques_PDV()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Lecture_L As Long, Lecture_C As Long
Dim Ecriture_L As Long, Ecriture_C As Long
Dim Nom As String, Gep As String, Centrale As String, SurfaceTranche As String, Typo As String, SegmentCA As String, QuotaText As String, enseigne As String


Sheets("FICHE1").Activate
Code = CLng(Sheets("FICHE1").Cells(13, 13))
Sheets("FICHE1").Cells(12, 13) = Code

Sheets("FICHE1").Cells(13, 13) = CStr(Code)

Sheets("BDD").Activate
Lecture_L = 2
For I = 2 To Sheets("BDD").Range("A100000").End(xlUp).Row
    If Cells(I, 1) = Code Then
        Nom = Cells(I, 2)
        Gep = Cells(I, 11)
        Centrale = Cells(I, 10)
        SurfaceTranche = Cells(I, 8)
        Typo = Cells(I, 12)
        SegmentCA = Cells(I, 15)
        QuotaText = Cells(I, 18)
        enseigne = Cells(I, 13)
    End If
Next I

Sheets("FICHE1").Activate
Cells(13, 36) = Nom
Cells(14, 36) = Gep
Cells(15, 36) = SurfaceTranche
Cells(16, 36) = Typo
Cells(17, 36) = Centrale
Cells(18, 36) = SegmentCA
Cells(19, 36) = QuotaText


'PrÈ remplissage auto de 3 critËres sur la fiche 1

Cells(14, 85) = SurfaceTranche
Cells(17, 85) = SegmentCA
Cells(18, 85) = QuotaText

'PrÈ remplissage des critËres et caractÈristiques PDV sur feuille piliers du textile

Sheets("piliers du textile").Cells(8, 3) = Code
Sheets("piliers du textile").Cells(8, 23) = Nom
Sheets("piliers du textile").Cells(9, 23) = Gep
Sheets("piliers du textile").Cells(10, 23) = SurfaceTranche
Sheets("piliers du textile").Cells(11, 23) = Typo
Sheets("piliers du textile").Cells(12, 23) = Centrale
Sheets("piliers du textile").Cells(13, 23) = SegmentCA
Sheets("piliers du textile").Cells(14, 23) = QuotaText

Sheets("piliers du textile").Cells(9, 79) = SurfaceTranche
Sheets("piliers du textile").Cells(12, 79) = SegmentCA
Sheets("piliers du textile").Cells(13, 79) = QuotaText

End Sub

Sub Criteères()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Lecture_L As Long
Dim Lecture_C As Long
Dim Ecriture_L As Long
Dim Ecriture_C As Long
Dim ligne As Long

Dim Criteère1 As String
Dim Criteère2 As String
Dim Criteère3 As String
Dim Criteère4 As String
Dim Criteère5 As String
Dim Criteère6 As String


Dim Nb_criteères As Integer
Dim Taille_Univers As Long

Sheets("FICHE1").Activate

Criteère1 = Sheets("FICHE1").Cells(14, 85) 'BDD Col 8
Criteère2 = Sheets("FICHE1").Cells(15, 85) 'BDD Col 12
Criteère3 = Sheets("FICHE1").Cells(16, 85) 'BDD Col 13
Criteère4 = Sheets("FICHE1").Cells(17, 85) 'BDD Col 15
Criteère5 = Sheets("FICHE1").Cells(18, 85) 'BDD Col 18
Criteère6 = Sheets("FICHE1").Cells(19, 85) 'BDD Col 10

Nb_criteères = Application.WorksheetFunction.CountA(Cells(14, 85), Cells(15, 85), Cells(16, 85), Cells(17, 85), Cells(18, 85), Cells(19, 85))

'RAZ de la feuille TEMP
Sheets("TEMP").Activate
Cells.ClearContents


Sheets("BDD").Activate
Sheets("BDD").[A1].AutoFilter
ligne = Sheets("BDD").Range("A900000").End(xlUp).Row

If Criteère1 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=8, Criteria1:=Criteère1
If Criteère2 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=12, Criteria1:=Criteère2
If Criteère3 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=13, Criteria1:=Criteère3
If Criteère4 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=15, Criteria1:=Criteère4
If Criteère5 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=18, Criteria1:=Criteère5
If Criteère6 <> "" Then: Sheets("BDD").[A1].AutoFilter Field:=10, Criteria1:=Criteère6

Set LF = Sheets("BDD").Range(Cells(1, 1), Cells(ligne, 40)).SpecialCells(xlCellTypeVisible)
LF.Copy
Sheets("TEMP").Activate
Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False


'Determination de la taille de l'univers de comparaison
Taille_Univers = 0
Taille_Univers = Application.WorksheetFunction.Subtotal(2, Sheets("TEMP").Range(Cells(2, 1), Cells(ligne, 1)))

'Message si univers de comparaison supÈrieur ‡ 30 magasins
If Taille_Univers > 30 Then
    Alancer = MsgBox(prompt:="Votre univers de comparaison comprend " & Taille_Univers & " magasins." & Chr(10) & Chr(10) & "Veuillez sÈlectionner plus de " & Nb_criteères & " critËre(s) pour vous comparer ‡ un maximum de 30 magasins" & Chr(10), Title:="Attention - Univers de comparaison trop important", Buttons:=vbOKOnly + vbExclamation + vbDefaultButton2)
    Sheets("FICHE1").Cells(1, 1) = 1
    If Alancer = vbYes Then GoTo Line1
Line1:
    Sheets("FICHE1").Activate
    Cells.Cells(13, 80) = ""
    Application.Goto Range("A1"), True
End If

Sheets("BDD").[A1].AutoFilter

Sheets("FICHE1").Cells(13, 80) = Taille_Univers
Sheets("FICHE1").Activate
Application.Goto Range("A1"), True

End Sub

Sub Ajoute_PDV()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim ligne As Integer
Dim Magasin As String, Temp As String, Taille_Univers As Integer

Magasin = InputBox("Veuillez indiquer le code associÈ du magasin que vous souhaitez ajouter ?", "Salon AH18 - Espace Performance")

Select Case Magasin
Case "": Exit Sub
Case Else
ligne = Sheets("TEMP").Range("A900000").End(xlUp).Row + 1

Sheets("BDD").Activate
For I = 2 To Range("A900000").End(xlUp).Row
    If Cells(I, 1) = Magasin Then
        For J = 1 To 40
            Sheets("TEMP").Cells(ligne, J) = Cells(I, J)
        Next J
    End If
Next I

End Select

Sheets("TEMP").Activate
ligne = Sheets("TEMP").Range("A900000").End(xlUp).Row
Taille_Univers = Application.WorksheetFunction.Subtotal(3, Range(Cells(2, 1), Cells(ligne, 1)))

Sheets("BDD").Activate
Call Ranking_Textile
Call Ranking_VDessus
Call Ranking_VDessous
Call Ranking_Equipement

Sheets("FICHE1").Cells(13, 13) = Sheets("FICHE1").Cells(12, 13)
Sheets("FICHE1").Cells(13, 80) = Taille_Univers
Sheets("FICHE1").Activate
Application.Goto Range("A1"), True

End Sub

Sub Ranking_Textile()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim compteur As Long
Dim Debut_liste_ranking As Integer

compteur = 1
Debut_liste_ranking = 28

Sheets("TEMP").Activate

While Cells(compteur, 1) <> ""
    compteur = compteur + 1
Wend
compteur = compteur - 1


'Etablissement du ranking Textile dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("P2:P" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 50) = "Ranking Textile"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 50) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking VDessus dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("S2:S" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 51) = "Ranking Vdessus"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 51) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking VDessous dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("Z2:Z" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 52) = "Ranking Vdessous"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 52) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking Equipement dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AI2:AI" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 53) = "Ranking Equipement"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 53) = compteur - 1
    compteur = compteur + 1
Wend


'Remise de TEMP dans l'ordre Ranking Textile
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("P2:P" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With


'Affichage des rÈsultats
compteur = 2
While Cells(compteur, 1) <> ""
    If compteur < 32 Then
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 1) = Cells(compteur, 1)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 8) = Cells(compteur, 2)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 20) = Cells(compteur, 9)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 25) = Cells(compteur, 50)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 38) = Cells(compteur, 51)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 52) = Cells(compteur, 52)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 66) = Cells(compteur, 53)
    End If
    compteur = compteur + 1
Wend


'Ligne = Sheets("FICHE1").Range("A59").End(xlUp).Row
'Sheets("FICHE1").Range("A30:X" & Ligne).Select
'',"AL30:BZ" & Compteur").Select
'With Selection.Borders(xlInsideHorizontal)
'    .LineStyle = xlContinuous
'    .ThemeColor = 1
'    .TintAndShade = -0.249946592608417
'    .Weight = xlHairline
'End With

Sheets("FICHE1").Activate
Cells(1, 1).Select
End Sub

   
Sub Ranking_VDessus()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim compteur As Long
Dim Debut_liste_ranking As Integer

compteur = 1
Debut_liste_ranking = 62

Sheets("TEMP").Activate

While Cells(compteur, 1) <> ""
    compteur = compteur + 1
Wend
compteur = compteur - 1


'Etablissement du ranking Layette dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("T2:T" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 54) = "Ranking Vlayette"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 54) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking VEnfant dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("U2:U" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 55) = "Ranking Venfant"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 55) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking VFemme dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("V2:V" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 56) = "Ranking Vfemme"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 56) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking VHomme dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("W2:W" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 57) = "Ranking Vhomme"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 57) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Nuit dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("X2:X" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 58) = "Ranking Nuit"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 58) = compteur - 1
    compteur = compteur + 1
Wend

'Etablissement du ranking Bain dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("Y2:Y" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 59) = "Ranking Bain"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 59) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking VDessus dans TEMP POUR AFFICHAGE
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("S2:S" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 51) = "Ranking Vdessus"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 51) = compteur - 1
    compteur = compteur + 1
Wend


'Affichage des rÈsultats
compteur = 2
While Cells(compteur, 1) <> ""
    If compteur < 32 Then
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 1) = Cells(compteur, 1)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 8) = Cells(compteur, 2)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 20) = Cells(compteur, 9)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 25) = Cells(compteur, 50)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 32) = Cells(compteur, 51)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 39) = Cells(compteur, 54)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 46) = Cells(compteur, 55)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 53) = Cells(compteur, 56)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 60) = Cells(compteur, 57)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 66) = Cells(compteur, 58)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 72) = Cells(compteur, 59)
    End If
    compteur = compteur + 1
Wend

Sheets("FICHE1").Activate
Cells(1, 1).Select
End Sub


Sub Ranking_VDessous()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim compteur As Long
Dim Debut_liste_ranking As Integer

compteur = 1
Debut_liste_ranking = 96

Sheets("TEMP").Activate

While Cells(compteur, 1) <> ""
    compteur = compteur + 1
Wend
compteur = compteur - 1


'Etablissement du ranking SVlayette dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AA2:AA" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 60) = "Ranking SVlayette"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 60) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking SVEnfant dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AB2:AB" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 61) = "Ranking SVenfant"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 61) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking SVFemme dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AC2:AC" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 62) = "Ranking SVfemme"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 62) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking SVHomme dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AD2:AD" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 63) = "Ranking SVhomme"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 63) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Chaussettes dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AE2:AE" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 64) = "Ranking Chaussettes"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 64) = compteur - 1
    compteur = compteur + 1
Wend

'Etablissement du ranking Collants dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AF2:AF" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 65) = "Ranking Collants"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 65) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Mercerie dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AG2:AG" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 66) = "Ranking Mercerie"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 66) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Semelles Lacets dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AH2:AH" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 67) = "Ranking Semelles Lacets"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 67) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking VDessous dans TEMP POUR AFFICHAGE
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("Z2:Z" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 52) = "Ranking Vdessous"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 52) = compteur - 1
    compteur = compteur + 1
Wend



'Affichage des rÈsultats
compteur = 2
While Cells(compteur, 1) <> ""
    If compteur < 32 Then
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 1) = Cells(compteur, 1)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 8) = Cells(compteur, 2)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 20) = Cells(compteur, 9)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 25) = Cells(compteur, 50)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 31) = Cells(compteur, 52)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 37) = Cells(compteur, 60)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 42) = Cells(compteur, 61)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 47) = Cells(compteur, 62)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 52) = Cells(compteur, 63)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 57) = Cells(compteur, 64)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 62) = Cells(compteur, 65)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 67) = Cells(compteur, 66)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 73) = Cells(compteur, 67)
    End If
    compteur = compteur + 1
Wend

Sheets("FICHE1").Activate
Cells(1, 1).Select
End Sub



Sub Ranking_Equipement()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim compteur As Long
Dim Debut_liste_ranking As Integer

compteur = 1
Debut_liste_ranking = 130

Sheets("TEMP").Activate

While Cells(compteur, 1) <> ""
    compteur = compteur + 1
Wend
compteur = compteur - 1


'Etablissement du ranking Linge de maison dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AJ2:AJ" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 68) = "Ranking Ldmaison"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 68) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking Puericulture dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AK2:AK" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 69) = "Ranking Pueri"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 69) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking Accessoires dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AL2:AL" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 70) = "Ranking Accessoires"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 70) = compteur - 1
    compteur = compteur + 1
Wend



'Etablissement du ranking Chaussures Exterieur dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AM2:AM" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 71) = "Ranking Chaussures Ext"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 71) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Chaussures Interieur dans TEMP
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AN2:AN" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 72) = "Ranking Chaussures Int"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 72) = compteur - 1
    compteur = compteur + 1
Wend


'Etablissement du ranking Equipement dans TEMP POUR AFFICHAGE
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("TEMP").Sort.SortFields.Add Key:=Range("AI2:AI" & compteur), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

With ActiveWorkbook.Worksheets("TEMP").Sort
    .SetRange Range("A1:BT" & compteur)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

Cells(1, 53) = "Ranking Equipement"
compteur = 2
While Cells(compteur, 1) <> ""
    Cells(compteur, 53) = compteur - 1
    compteur = compteur + 1
Wend



'Affichage des rÈsultats
compteur = 2
While Cells(compteur, 1) <> ""
    If compteur < 32 Then
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 1) = Cells(compteur, 1)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 8) = Cells(compteur, 2)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 20) = Cells(compteur, 9)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 25) = Cells(compteur, 50)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 33) = Cells(compteur, 53)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 41) = Cells(compteur, 68)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 49) = Cells(compteur, 69)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 57) = Cells(compteur, 70)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 65) = Cells(compteur, 71)
        Sheets("FICHE1").Cells(compteur + Debut_liste_ranking, 72) = Cells(compteur, 72)
    End If
    compteur = compteur + 1
Wend

Sheets("FICHE1").Activate
Cells(1, 1).Select
End Sub



Sub Objectif_Dessus()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

Cells(50, 91) = Cells(69, 91)
Cells(50, 96) = Cells(69, 96)
Cells(50, 101) = Cells(69, 101)
Cells(50, 106) = Cells(69, 106)
Cells(50, 111) = Cells(69, 111)
Cells(50, 116) = Cells(69, 111) + Cells(69, 85)

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range("AM64:BZ93").Interior.Color = 16777215
Application.Goto Range("A96"), True


End Sub


Sub Objectif_Dessous()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

Cells(53, 91) = Cells(103, 91)
Cells(53, 96) = Cells(103, 96)
Cells(53, 101) = Cells(103, 101)
Cells(53, 106) = Cells(103, 106)
Cells(53, 111) = Cells(103, 111)
Cells(53, 116) = Cells(103, 111) + Cells(103, 85)

Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range("AK98:BZ127").Interior.Color = 16777215
Application.Goto Range("A130"), True

End Sub

Sub Objectif_Equipement()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Sheets("FICHE1").Activate

Cells(56, 91) = Cells(139, 91)
Cells(56, 96) = Cells(139, 96)
Cells(56, 101) = Cells(139, 101)
Cells(56, 106) = Cells(139, 106)
Cells(56, 111) = Cells(139, 111)
Cells(56, 116) = Cells(139, 111) + Cells(139, 85)

Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range("AO132:BZ161").Interior.Color = 16777215
Application.Goto Range("A26"), True

End Sub

Sub Sauvegarde_et_Impression_Dossier()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Fichier As String, Source As String
Dim Code_PDV As String, Nom_PDV As String
Dim Sheet_Name As String
Dim Temps As String

Dim ws As Worksheet

Call Compilation_Data
Call Envoi_data_BDD
 
'Source = ActiveWorkbook.Name
'Code_PDV = Sheets("FICHE1").Cells(13, 13)
'Nom_PDV = Sheets("FICHE1").Cells(13, 36)
'Sheet_Name = ActiveSheet.Name
'
'Nom_PDV = Replace(Nom_PDV, "/", "")
'Temps = Now()
'Temps = Replace(Temps, "/", "_")
'Temps = Replace(Temps, ":", "_")
'
'Sheets(Array("Sommaire", "FICHE1", "piliers du textile", "definition et outils ‡ dispo")).Copy
'ChDir _
'"G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\10. Dossiers Finaux"
'
'ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
'"G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\10. Dossiers Finaux\" & Code_PDV & " - " & Nom_PDV & Temps & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=False, IgnorePrintAreas:=False, OpenAfterPublish:=False
'Fichier = ActiveWorkbook.Name

'ActiveWorkbook.SaveAs Filename:= _
'"G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\10. Dossiers Finaux\" & Code_PDV & " - " & Nom_PDV & Temps & ".xlsb", FileFormat:=50
'Fichier = ActiveWorkbook.Name

'Sheets("FICHE1").Activate
'Cells.Select: Selection.Copy
'Selection.PasteSpecial Paste:=xlPasteValues
'Application.CutCopyMode = False
'Application.Goto Range("A1"), True
'
'
'Sheets("Piliers du Textile").Activate
'Cells.Select: Selection.Copy
'Selection.PasteSpecial Paste:=xlPasteValues
'Application.CutCopyMode = False
'Application.Goto Range("A1"), True

'Workbooks(Fichier).Close False
'
'Windows(Source).Activate
'
'Sheets("Sommaire").Activate: ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False
'Sheets("FICHE1").Activate: ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False
'Sheets("piliers du textile").Activate: ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False
'Sheets("definition et outils ‡ dispo").Activate: ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False

Application.Goto Sheets(Sheet_Name).Range("A1"), True

End Sub

Sub Ouverture_Incontournables_Pdf()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_PDV As String
Dim Chemin As String

Code_PDV = Sheets("Piliers du Textile").Cells(8, 3)

'Chemin = "\\groupement.systeme-u.fr\dfs_cn_cn\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\3_Incontournables\PDF\" & Code_PDV & ".pdf"
'Chemin = "G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\3_Incontournables\PDF\" & Code_PDV & ".pdf"
Chemin = "C:\Users\amechin\Documents\1_Incontournables\" & Code_PDV & ".pdf"
ActiveWorkbook.FollowHyperlink Address:=Chemin, NewWindow:=True

Application.Goto Sheets("Piliers du Textile").Range("A1"), True
End Sub

Sub Ouverture_Indispensables_Pdf()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_PDV As String
Dim Chemin As String

Code_PDV = Sheets("Piliers du Textile").Cells(8, 3)

'Chemin = "\\groupement.systeme-u.fr\dfs_cn_cn\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\4_Indispensables\" & Code_PDV & ".pdf"
'Chemin = "G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\4_Indispensables\" & Code_PDV & ".pdf"
Chemin = "C:\Users\amechin\Documents\2_Indispensables\" & Code_PDV & ".pdf"
ActiveWorkbook.FollowHyperlink Address:=Chemin, NewWindow:=True

Application.Goto Sheets("Piliers du Textile").Range("A1"), True
End Sub

Sub Ouverture_Bestof_Pdf()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_PDV As String
Dim Chemin As String

Code_PDV = Sheets("Piliers du Textile").Cells(8, 3)

'Chemin = "\\groupement.systeme-u.fr\dfs_cn_cn\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\5_Best_of\" & Code_PDV & ".pdf"
'Chemin = "G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\5_Best_of\" & Code_PDV & ".pdf"
Chemin = "C:\Users\amechin\Documents\3_Bestof\" & Code_PDV & ".pdf"
ActiveWorkbook.FollowHyperlink Address:=Chemin, NewWindow:=True

Application.Goto Sheets("Piliers du Textile").Range("A1"), True
End Sub

Sub Efface_Fiche1()

Application.ScreenUpdating = True
Application.DisplayAlerts = False

Dim Compteur_ As Long

Sheets("FICHE1").Activate

'RAZ indicateur dÈpassement univers
'    Sheets("FICHE1").Cells(1, 1) = ""
'
'RAZ nb magasins univers
'    Sheets("FICHE1").Cells(13, 80) = ""
    
Application.ScreenUpdating = False

'RAZ Ranking Textile
compteur = 30
While compteur < 60
    Cells(compteur, 1) = ""
    Cells(compteur, 8) = ""
    Cells(compteur, 20) = ""
    Cells(compteur, 25) = ""
    Cells(compteur, 38) = ""
    Cells(compteur, 52) = ""
    Cells(compteur, 66) = ""
compteur = compteur + 1
Wend


'RAZ Ranking VDessus
compteur = 64
While compteur < 94
    Cells(compteur, 1) = ""
    Cells(compteur, 8) = ""
    Cells(compteur, 20) = ""
    Cells(compteur, 25) = ""
    Cells(compteur, 32) = ""
    Cells(compteur, 39) = ""
    Cells(compteur, 46) = ""
    Cells(compteur, 53) = ""
    Cells(compteur, 60) = ""
    Cells(compteur, 66) = ""
    Cells(compteur, 72) = ""
compteur = compteur + 1
Wend


'RAZ Ranking VDessous
compteur = 98
While compteur < 128
    Cells(compteur, 1) = ""
    Cells(compteur, 8) = ""
    Cells(compteur, 20) = ""
    Cells(compteur, 25) = ""
    Cells(compteur, 31) = ""
    Cells(compteur, 37) = ""
    Cells(compteur, 42) = ""
    Cells(compteur, 47) = ""
    Cells(compteur, 52) = ""
    Cells(compteur, 57) = ""
    Cells(compteur, 62) = ""
    Cells(compteur, 67) = ""
    Cells(compteur, 73) = ""
compteur = compteur + 1
Wend


'RAZ Ranking Equipement
compteur = 132
While compteur < 162
    Cells(compteur, 1) = ""
    Cells(compteur, 8) = ""
    Cells(compteur, 20) = ""
    Cells(compteur, 25) = ""
    Cells(compteur, 33) = ""
    Cells(compteur, 41) = ""
    Cells(compteur, 49) = ""
    Cells(compteur, 57) = ""
    Cells(compteur, 65) = ""
    Cells(compteur, 72) = ""
compteur = compteur + 1
Wend

'RAZ Obj gÈnÈral
    Cells(50, 85) = ""
    Cells(50, 91) = ""
    Cells(50, 96) = ""
    Cells(50, 101) = ""
    Cells(50, 106) = ""
    Cells(50, 111) = ""

    Cells(53, 85) = ""
    Cells(53, 91) = ""
    Cells(53, 96) = ""
    Cells(53, 101) = ""
    Cells(53, 106) = ""
    Cells(53, 111) = ""

    Cells(56, 85) = ""
    Cells(56, 91) = ""
    Cells(56, 96) = ""
    Cells(56, 101) = ""
    Cells(56, 106) = ""
    Cells(56, 111) = ""

'RAZ Obj Dessus
    Cells(72, 91) = ""
    Cells(71, 106) = 0
    Cells(75, 91) = ""
    Cells(74, 106) = 0
    Cells(78, 91) = ""
    Cells(77, 106) = 0
    Cells(81, 91) = ""
    Cells(80, 106) = 0
    Cells(84, 91) = ""
    Cells(83, 106) = 0
    Cells(87, 91) = ""
    Cells(86, 106) = 0

'RAZ Obj Dessous
    Cells(106, 91) = ""
    Cells(105, 106) = 0
    Cells(109, 91) = ""
    Cells(108, 106) = 0
    Cells(112, 91) = ""
    Cells(111, 106) = 0
    Cells(115, 91) = ""
    Cells(114, 106) = 0
    Cells(118, 91) = ""
    Cells(107, 106) = 0
    Cells(121, 91) = ""
    Cells(120, 106) = 0
    Cells(124, 91) = ""
    Cells(123, 106) = 0
    Cells(127, 91) = ""
    Cells(126, 106) = 0

'RAZ Obj Dessous
    Cells(142, 91) = ""
    Cells(141, 106) = 0
    Cells(145, 91) = ""
    Cells(144, 106) = 0
    Cells(148, 91) = ""
    Cells(143, 106) = 0
    Cells(151, 91) = ""
    Cells(150, 106) = 0
    Cells(154, 91) = ""
    Cells(153, 106) = 0
    
'Call RAZ_CritËres
'Call RAZ_Caract_PDV

End Sub

Sub Send_Mail()
Call ListeFichiers
Call Mail
End Sub


Sub Mail()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

    Dim iMsg As Object
    Dim iConf As Object
    Dim Strbody As String
    Dim Flds As Variant

    Dim Identifiant As String
    Dim Dest As String
    Dim Objet As String
    Dim DestCC As String
    Dim DestCM As String
    Dim Corp_Mess As String
    Dim PJointe1 As String
    Dim PJointe2 As String
    Dim PJointe3 As String
    Dim PJointe4 As String
    
    Identifiant = Range("Identifiant").Value
    Dest = InputBox("Mail du magasin?", "Salon PE18 - Espace Performance")
    If MsgBox("L'adresse saisie est : " & Dest & " Etes vous s˚r?", vbYesNo) = vbNo Then
        Dest = InputBox("Mail du magasin?", "Salon PE18 - Espace Performance")
        Sheets("Data PDV").Cells(5, 20) = Dest
    End If
    
    Objet = Range("Objet").Value
    DestCC = Range("DestCC").Value
    DestCM = Range("DestCM").Value
    Corp_Mess = Range("Corp_Mess").Value
    PJointe1 = Range("PJointe").Value
    PJointe2 = Range("PJointe2").Value
    PJointe3 = Range("PJointe3").Value
    PJointe4 = Range("PJointe4").Value
    Serveur = "messagerie-app"

    Set iMsg = CreateObject("CDO.Message")
    Set iConf = CreateObject("CDO.Configuration")

    iConf.Load -1    ' CDO Source Defaults
    Set Flds = iConf.Fields
    With Flds
      
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = Serveur
        .Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25
        .Update
    End With
 
    With iMsg
        Set .Configuration = iConf
        .From = Identifiant
        .To = Dest
        .CC = DestCC
        .BCC = DestCM
        .Subject = Objet
        .TextBody = Corp_Mess
        .AddAttachment PJointe1
        .AddAttachment PJointe2
        .AddAttachment PJointe3
        .AddAttachment PJointe4
        .Send
        
        DoEvents
        
        MsgBox ("Votre message a bien ÈtÈ envoyÈ")
                
    End With

End Sub


Sub ListeFichiers()
  
  Application.ScreenUpdating = False
  
  Sheets("Mail").Activate
  Sheets("Mail").Range("D2:E65000").ClearContents
  
  repertoire = "G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\10. Dossiers Finaux\" ' adapter
  [H2] = repertoire
  ligne = 2
  nf = Dir(repertoire & "*.*")      'premier fichier xls
  Do While nf <> ""
    Cells(ligne, 5) = nf
    Cells(ligne, 4) = Left(Cells(ligne, 5), 5)
    
    'Cells(ligne, 2) = FileDateTime(nf)
    'Cells(ligne, 3) = FileLen(nf)
    ligne = ligne + 1
    nf = Dir ' suivant
  Loop
End Sub


Sub Objectif_Rang()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Num_Associe As String, Num_Temp As String
Dim Position_Rayon As Integer, Rang_Rayon As Integer

Sheets("FICHE1").Activate

Num_Associe = Sheets("FICHE1").Cells(13, 13)
For I = 2 To Sheets("TEMP").Range("A900000").End(xlUp).Row
Num_Temp = Sheets("TEMP").Cells(I, 1)

If Num_Temp = Num_Associe Then
    
    For J = 54 To 72
        Rang_Rayon = Sheets("TEMP").Cells(I, J)
        Select Case J
            Case 54: Position_Rayon = 72
            Case 55: Position_Rayon = 75
            Case 56: Position_Rayon = 78
            Case 57: Position_Rayon = 81
            Case 58: Position_Rayon = 84
            Case 59: Position_Rayon = 87
            
            Case 60: Position_Rayon = 106
            Case 61: Position_Rayon = 109
            Case 62: Position_Rayon = 112
            Case 63: Position_Rayon = 115
            Case 64: Position_Rayon = 118
            Case 65: Position_Rayon = 121
            Case 66: Position_Rayon = 124
            Case 67: Position_Rayon = 127
            
            Case 68: Position_Rayon = 142
            Case 69: Position_Rayon = 145
            Case 70: Position_Rayon = 148
            Case 71: Position_Rayon = 151
            Case 72: Position_Rayon = 154
        End Select
        If Rang_Rayon > 1 Then
            Sheets("FICHE1").Cells(Position_Rayon, 91) = Rang_Rayon - 1
        Else
            Sheets("FICHE1").Cells(Position_Rayon, 91) = Rang_Rayon
        End If
    Next J
    End If
Next I

Application.Goto Range("A1"), True

End Sub


Sub Couleur_Mag_Objectif_Rang_Layette()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 39)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 46)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 53)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 60)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 66)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(72, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 39) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 39).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Enfant()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 39)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 46)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 53)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 60)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 66)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(75, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 46) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 46).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub


Sub Couleur_Mag_Objectif_Rang_Femme()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 39)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 46)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 53)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 60)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 66)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215


'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(78, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 53) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 53).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Homme()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 39)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 46)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 53)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 60)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 66)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(81, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 60) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 60).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub
Sub Couleur_Mag_Objectif_Rang_Nuit()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 39)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 46)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 53)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 60)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 66)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(84, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 66) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 66).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Bain()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(64, 8), Cells(93, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(64, 39), Cells(93, 72)).Interior.Color = 16777215


'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(87, 91)

For I = 64 To 93
    If Sheets("FICHE1").Cells(I, 72) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 72).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub


Sub Couleur_Mag_Objectif_Rang_SVLayette()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(106, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 37) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 37).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub


Sub Couleur_Mag_Objectif_Rang_SVEnfant()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(109, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 42) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 42).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_SVFemme()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(112, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 47) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 47).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_SVHomme()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(115, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 52) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 52).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Cho7()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(118, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 57) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 57).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Collants()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(121, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 62) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 62).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Mercerie()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(124, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 67) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 67).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Semelles()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(98, 8), Cells(127, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(98, 37), Cells(127, 73)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(127, 91)

For I = 98 To 127
    If Sheets("FICHE1").Cells(I, 73) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 73).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_LDM()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(132, 41), Cells(161, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(142, 91)

For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 41) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 41).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub


Sub Couleur_Mag_Objectif_Rang_Pueri()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(132, 41), Cells(161, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(145, 91)

For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 49) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 49).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Accessoires()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(132, 41), Cells(161, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(148, 91)

For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 57) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 57).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Chaussures_Ext()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(132, 41), Cells(161, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(151, 91)

For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 65) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 65).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Couleur_Mag_Objectif_Rang_Chaussures_Int()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Rang_Cible As Integer

'Cleaning
Sheets("FICHE1").Range(Cells(132, 8), Cells(161, 8)).Interior.Color = 16777215
Sheets("FICHE1").Range(Cells(132, 41), Cells(161, 72)).Interior.Color = 16777215

'RÈcupÈration du rang
Rang_Cible = Sheets("FICHE1").Cells(154, 91)

For I = 132 To 161
    If Sheets("FICHE1").Cells(I, 72) = Rang_Cible Then
        Sheets("FICHE1").Cells(I, 8).Interior.Color = RGB(250, 230, 153)
        Sheets("FICHE1").Cells(I, 72).Interior.Color = RGB(250, 230, 153)
    End If
Next

End Sub

Sub Prise_de_note()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Note As String
'Emplacement de la fenetre pour un Ècran seul en commentaire
'Note = InputBox("Saisissez un commentaire", "Commentaires", , 23000, 13000)
Note = InputBox("Saisissez un commentaire", "Commentaires", , 0, 0)
If Note <> "" Then
    If Sheets("Data PDV").Cells(5, 21) <> "" Then
        Sheets("Data PDV").Cells(5, 21) = Sheets("Data PDV").Cells(5, 21) & " | " & Note
        Else
            Sheets("Data PDV").Cells(5, 21) = Note
            End If
            
    If Sheets("Data PDV").Cells(5, 22) <> "" Then
        Sheets("Data PDV").Cells(5, 22) = Sheets("Data PDV").Cells(5, 22) & Chr(10) & Note
        Else
            Sheets("Data PDV").Cells(5, 22) = Note
            End If
End If
End Sub

Sub Affiche_note()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Note As String

Note = Sheets("Data PDV").Cells(5, 22)

MsgBox (Note)

End Sub


Sub Compilation_Data()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Code_Associe As String, Mag As String, Gep As String, Tranche_Surface As String, Typologie_site As String, Etablissement As String, Tranche_CA As String, Quota_textile As String
Dim CA_N_1 As Double, Evol_N_1 As Double, Univers_N_1 As Double, Objectif_pourcent As String, Objectif_valeur As String
Dim pilier1_incontournables As Double, pilier2_indispensables As Double, pilier3_TG_TA As Double, pilier4_bestof As Double, Total_piliers As Double

Code_Associe = Sheets("FICHE1").Cells(13, 13)
Mag = Sheets("FICHE1").Cells(13, 36)
Gep = Sheets("FICHE1").Cells(14, 36)
Tranche_Surface = Sheets("FICHE1").Cells(15, 36)
Typologie_site = Sheets("FICHE1").Cells(16, 36)
Etablissement = Sheets("FICHE1").Cells(17, 36)
Tranche_CA = Sheets("FICHE1").Cells(18, 36)
Quota_textile = Sheets("FICHE1").Cells(19, 36)

CA_N_1 = Sheets("Piliers du Textile").Cells(26, 11)
Evol_N_1 = Sheets("Piliers du Textile").Cells(26, 17)
Univers_N_1 = Sheets("Piliers du Textile").Cells(26, 22)
Objectif_pourcent = Sheets("Piliers du Textile").Cells(26, 27)
Objectif_valeur = Sheets("Piliers du Textile").Cells(26, 32)

pilier1_incontournables = Sheets("Piliers du Textile").Cells(26, 37)
pilier2_indispensables = Sheets("Piliers du Textile").Cells(26, 47)
pilier3_TG_TA = Sheets("Piliers du Textile").Cells(26, 57)
pilier4_bestof = Sheets("Piliers du Textile").Cells(26, 67)
Total_piliers = Sheets("Piliers du Textile").Cells(26, 77)


' Recopie des donnÈes dans Data PDV

    Sheets("Data PDV").Activate
    Sheets("Data PDV").Cells(5, 1) = Date
    Sheets("Data PDV").Cells(5, 2) = Code_Associe
    Sheets("Data PDV").Cells(5, 3) = Mag
    Sheets("Data PDV").Cells(5, 4) = Gep
    Sheets("Data PDV").Cells(5, 5) = Tranche_Surface
    Sheets("Data PDV").Cells(5, 6) = Typologie_site
    Sheets("Data PDV").Cells(5, 7) = Etablissement
    Sheets("Data PDV").Cells(5, 8) = Tranche_CA
    Sheets("Data PDV").Cells(5, 9) = Quota_textile
    
    Sheets("Data PDV").Cells(5, 10) = CA_N_1
    Sheets("Data PDV").Cells(5, 11) = Evol_N_1
    Sheets("Data PDV").Cells(5, 12) = Univers_N_1
    Sheets("Data PDV").Cells(5, 13) = Objectif_pourcent
    Sheets("Data PDV").Cells(5, 14) = Objectif_valeur

    Sheets("Data PDV").Cells(5, 15) = pilier1_incontournables
    Sheets("Data PDV").Cells(5, 16) = pilier2_indispensables
    Sheets("Data PDV").Cells(5, 17) = pilier3_TG_TA
    Sheets("Data PDV").Cells(5, 18) = pilier4_bestof
    Sheets("Data PDV").Cells(5, 19) = Total_piliers

End Sub

Sub Envoi_data_BDD()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Fichier As String, Source As String
Dim ligne As Long
Dim Variable_temp As String

Source = ActiveWorkbook.Name
' Etape 1 - Ouverture du fichier Synthese
    
    Fichier = "G:\Dir_Commerciale\Textile\Projet Orga\19_Emulation\#1 Stand_performance_AH18\1_Trame\Espace Performance - Synthese.xlsx"
    Workbooks.Open Filename:=Fichier
    Fichier = ActiveWorkbook.Name
    ligne = Sheets("Base EP").Range("A900000").End(xlUp).Row + 1
    
' Etape 2 - Recopie des donnÈes prÈsentes dans l'onglet data PDV

    For I = 1 To 21
        Workbooks(Fichier).Sheets("Base EP").Cells(ligne, I) = Workbooks(Source).Sheets("Data PDV").Cells(5, I)
    Next I
    
    Workbooks(Fichier).Save
    Workbooks(Fichier).Close
    
    Workbooks(Source).Activate
    Sheets("FICHE1").Activate
    Application.Goto Range("A1")
End Sub


Sub Affichage_evolution()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim Textile As Double
Dim Dessus As Double
Dim Dessous As Double
Dim Equipement As Double

Dim Textile_Univ As Double
Dim Dessus_Univ As Double
Dim Dessous_Univ As Double
Dim Equipement_Univ As Double



Dim Layette As Double
Dim Enfant As Double
Dim Femme As Double
Dim Homme As Double
Dim Bain As Double
Dim Nuit As Double

Dim Layette_Univ As Double
Dim Enfant_Univ As Double
Dim Femme_Univ As Double
Dim Homme_Univ As Double
Dim Bain_Univ As Double
Dim Nuit_Univ As Double



Dim Svt_layette As Double
Dim Svt_enfant As Double
Dim Svt_femme As Double
Dim Svt_homme As Double
Dim Chaussette As Double
Dim Collant As Double
Dim Mercerie As Double
Dim Semelle_lacet As Double

Dim Svt_layette_Univ As Double
Dim Svt_enfant_Univ As Double
Dim Svt_femme_Univ As Double
Dim Svt_homme_Univ As Double
Dim Chaussette_Univ As Double
Dim Collant_Univ As Double
Dim Mercerie_Univ As Double
Dim Semelle_lacet_Univ As Double



Dim LDM As Double
Dim Puericulture As Double
Dim Accessoire As Double
Dim Chaussure_ext As Double
Dim Chaussure_int As Double

Dim LDM_Univ As Double
Dim Puericulture_Univ As Double
Dim Accessoire_Univ As Double
Dim Chaussure_ext_Univ As Double
Dim Chaussure_int_Univ As Double


' ---------------- RECUP EVOL GROUPES ------------------
' Mon Magasin
    Textile = Sheets("Piliers du Textile").Cells(26, 17)
    Dessus = Sheets("Piliers du Textile").Cells(28, 17)
    Dessous = Sheets("Piliers du Textile").Cells(42, 17)
    Equipement = Sheets("Piliers du Textile").Cells(60, 17)
    
'Mon Univers de comparaison
    Textile_Univ = Sheets("Piliers du Textile").Cells(26, 22)
    Dessus_Univ = Sheets("Piliers du Textile").Cells(28, 22)
    Dessous_Univ = Sheets("Piliers du Textile").Cells(42, 22)
    Equipement_Univ = Sheets("Piliers du Textile").Cells(60, 22)


' ---------------- RECUP EVOL VDESSUS ------------------
'Mon Magasin
    Layette = Sheets("Piliers du Textile").Cells(30, 17)
    Enfant = Sheets("Piliers du Textile").Cells(32, 17)
    Femme = Sheets("Piliers du Textile").Cells(34, 17)
    Homme = Sheets("Piliers du Textile").Cells(36, 17)
    Nuit = Sheets("Piliers du Textile").Cells(38, 17)
    Bain = Sheets("Piliers du Textile").Cells(40, 17)

    
'Mon Univers de comparaison
    Layette_Univ = Sheets("Piliers du Textile").Cells(30, 22)
    Enfant_Univ = Sheets("Piliers du Textile").Cells(32, 22)
    Femme_Univ = Sheets("Piliers du Textile").Cells(34, 22)
    Homme_Univ = Sheets("Piliers du Textile").Cells(36, 22)
    Nuit_Univ = Sheets("Piliers du Textile").Cells(38, 22)
    Bain_Univ = Sheets("Piliers du Textile").Cells(40, 22)



' ---------------- RECUP EVOL VDESSOUS ------------------
'Mon Magasin
    Svt_layette = Sheets("Piliers du Textile").Cells(44, 17)
    Svt_enfant = Sheets("Piliers du Textile").Cells(46, 17)
    Svt_femme = Sheets("Piliers du Textile").Cells(48, 17)
    Svt_homme = Sheets("Piliers du Textile").Cells(50, 17)
    Chaussette = Sheets("Piliers du Textile").Cells(52, 17)
    Collant = Sheets("Piliers du Textile").Cells(54, 17)
    Mercerie = Sheets("Piliers du Textile").Cells(56, 17)
    Semelle_lacet = Sheets("Piliers du Textile").Cells(58, 17)
    
'Mon Univers de comparaison
    Svt_layette_Univ = Sheets("Piliers du Textile").Cells(44, 22)
    Svt_enfant_Univ = Sheets("Piliers du Textile").Cells(46, 22)
    Svt_femme_Univ = Sheets("Piliers du Textile").Cells(48, 22)
    Svt_homme_Univ = Sheets("Piliers du Textile").Cells(50, 22)
    Chaussette_Univ = Sheets("Piliers du Textile").Cells(52, 22)
    Collant_Univ = Sheets("Piliers du Textile").Cells(54, 22)
    Mercerie_Univ = Sheets("Piliers du Textile").Cells(56, 22)
    Semelle_lacet_Univ = Sheets("Piliers du Textile").Cells(58, 22)


' ---------------- RECUP EVOL EQUIPEMENT ------------------
'Mon Magasin
    LDM = Sheets("Piliers du Textile").Cells(62, 17)
    Puericulture = Sheets("Piliers du Textile").Cells(64, 17)
    Accessoire = Sheets("Piliers du Textile").Cells(66, 17)
    Chaussure_ext = Sheets("Piliers du Textile").Cells(68, 17)
    Chaussure_int = Sheets("Piliers du Textile").Cells(70, 17)
    
'Mon Univers de comparaison
    LDM_Univ = Sheets("Piliers du Textile").Cells(62, 22)
    Puericulture_Univ = Sheets("Piliers du Textile").Cells(64, 22)
    Accessoire_Univ = Sheets("Piliers du Textile").Cells(66, 22)
    Chaussure_ext_Univ = Sheets("Piliers du Textile").Cells(68, 22)
    Chaussure_int_Univ = Sheets("Piliers du Textile").Cells(70, 22)


'---------------------------------------------------------
'
' Suppression des commentaires
'
'---------------------------------------------------------

For I = 47 To 56
    Sheets("FICHE1").Cells(I, 85).ClearComments
    I = I + 2
Next I

For I = 69 To 87
    Sheets("FICHE1").Cells(I, 85).ClearComments
    I = I + 2
Next I

For I = 103 To 127
    Sheets("FICHE1").Cells(I, 85).ClearComments
    I = I + 2
Next I

For I = 139 To 154
    Sheets("FICHE1").Cells(I, 85).ClearComments
    I = I + 2
Next I

'---------------------------------------------------------
'
' Ajout de l'Èvolution en commentaire
'
'---------------------------------------------------------


' E. Textile
Sheets("FICHE1").Cells(47, 85).AddComment
Sheets("FICHE1").Cells(47, 85).Comment.Text Text:="Magasin : " & Format(Textile * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Textile_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(47, 85).Comment.Shape.TextFrame.AutoSize = True


' E. VDessus
Sheets("FICHE1").Cells(50, 85).AddComment
Sheets("FICHE1").Cells(50, 85).Comment.Text Text:="Magasin : " & Format(Dessus * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Dessus_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(50, 85).Comment.Shape.TextFrame.AutoSize = True

Sheets("FICHE1").Cells(69, 85).AddComment
Sheets("FICHE1").Cells(69, 85).Comment.Text Text:="Magasin : " & Format(Dessus * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Dessus_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(69, 85).Comment.Shape.TextFrame.AutoSize = True


' E. VDessous
Sheets("FICHE1").Cells(53, 85).AddComment
Sheets("FICHE1").Cells(53, 85).Comment.Text Text:="Magasin : " & Format(Dessous * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Dessous_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(53, 85).Comment.Shape.TextFrame.AutoSize = True

Sheets("FICHE1").Cells(103, 85).AddComment
Sheets("FICHE1").Cells(103, 85).Comment.Text Text:="Magasin : " & Format(Dessous * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Dessous_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(103, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Equipement
Sheets("FICHE1").Cells(56, 85).AddComment
Sheets("FICHE1").Cells(56, 85).Comment.Text Text:="Magasin : " & Format(Equipement * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Equipement_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(56, 85).Comment.Shape.TextFrame.AutoSize = True

Sheets("FICHE1").Cells(139, 85).AddComment
Sheets("FICHE1").Cells(139, 85).Comment.Text Text:="Magasin : " & Format(Equipement * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Equipement_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(139, 85).Comment.Shape.TextFrame.AutoSize = True



' E. Layette
Sheets("FICHE1").Cells(72, 85).AddComment
Sheets("FICHE1").Cells(72, 85).Comment.Text Text:="Magasin : " & Format(Layette * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Layette_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(72, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Enfant
Sheets("FICHE1").Cells(75, 85).AddComment
Sheets("FICHE1").Cells(75, 85).Comment.Text Text:="Magasin : " & Format(Enfant * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Enfant_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(75, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Femme
Sheets("FICHE1").Cells(78, 85).AddComment
Sheets("FICHE1").Cells(78, 85).Comment.Text Text:="Magasin : " & Format(Femme * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Femme_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(78, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Homme
Sheets("FICHE1").Cells(81, 85).AddComment
Sheets("FICHE1").Cells(81, 85).Comment.Text Text:="Magasin : " & Format(Homme * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Homme_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(81, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Nuit
Sheets("FICHE1").Cells(84, 85).AddComment
Sheets("FICHE1").Cells(84, 85).Comment.Text Text:="Magasin : " & Format(Nuit * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Nuit_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(84, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Bain
Sheets("FICHE1").Cells(87, 85).AddComment
Sheets("FICHE1").Cells(87, 85).Comment.Text Text:="Magasin : " & Format(Bain * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Bain_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(87, 85).Comment.Shape.TextFrame.AutoSize = True







' E. Svt_layette
Sheets("FICHE1").Cells(106, 85).AddComment
Sheets("FICHE1").Cells(106, 85).Comment.Text Text:="Magasin : " & Format(Svt_layette * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Svt_layette_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(106, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Svt_enfant
Sheets("FICHE1").Cells(109, 85).AddComment
Sheets("FICHE1").Cells(109, 85).Comment.Text Text:="Magasin : " & Format(Svt_enfant * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Svt_enfant_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(109, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Svt_femme
Sheets("FICHE1").Cells(112, 85).AddComment
Sheets("FICHE1").Cells(112, 85).Comment.Text Text:="Magasin : " & Format(Svt_femme * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Svt_femme_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(112, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Svt_homme
Sheets("FICHE1").Cells(115, 85).AddComment
Sheets("FICHE1").Cells(115, 85).Comment.Text Text:="Magasin : " & Format(Svt_homme * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Svt_homme_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(115, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Chaussette
Sheets("FICHE1").Cells(118, 85).AddComment
Sheets("FICHE1").Cells(118, 85).Comment.Text Text:="Magasin : " & Format(Chaussette * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Chaussette_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(118, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Collant
Sheets("FICHE1").Cells(121, 85).AddComment
Sheets("FICHE1").Cells(121, 85).Comment.Text Text:="Magasin : " & Format(Collant * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Collant_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(121, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Mercerie
Sheets("FICHE1").Cells(124, 85).AddComment
Sheets("FICHE1").Cells(124, 85).Comment.Text Text:="Magasin : " & Format(Mercerie * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Mercerie_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(124, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Semelle_lacet
Sheets("FICHE1").Cells(127, 85).AddComment
Sheets("FICHE1").Cells(127, 85).Comment.Text Text:="Magasin : " & Format(Semelle_lacet * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Semelle_lacet_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(127, 85).Comment.Shape.TextFrame.AutoSize = True





' E. LDM
Sheets("FICHE1").Cells(142, 85).AddComment
Sheets("FICHE1").Cells(142, 85).Comment.Text Text:="Magasin : " & Format(LDM * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(LDM_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(142, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Puericulture
Sheets("FICHE1").Cells(145, 85).AddComment
Sheets("FICHE1").Cells(145, 85).Comment.Text Text:="Magasin : " & Format(Puericulture * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Puericulture_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(145, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Accessoire
Sheets("FICHE1").Cells(148, 85).AddComment
Sheets("FICHE1").Cells(148, 85).Comment.Text Text:="Magasin : " & Format(Accessoire * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Accessoire_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(148, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Chaussure_ext
Sheets("FICHE1").Cells(151, 85).AddComment
Sheets("FICHE1").Cells(151, 85).Comment.Text Text:="Magasin : " & Format(Chaussure_ext * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Chaussure_ext_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(151, 85).Comment.Shape.TextFrame.AutoSize = True


' E. Chaussure_int
Sheets("FICHE1").Cells(154, 85).AddComment
Sheets("FICHE1").Cells(154, 85).Comment.Text Text:="Magasin : " & Format(Chaussure_int * 100, "0.0") & "%" & Chr(10) & "Univers : " & Format(Chaussure_int_Univ * 100, "0.0") & "%"
Sheets("FICHE1").Cells(154, 85).Comment.Shape.TextFrame.AutoSize = True


End Sub


